<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto+Serif+SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","images":"/images","scheme":"Gemini","version":"8.1.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":true,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":"ture","mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"},"path":"/search.xml","localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false}};
  </script>
<meta name="description" content="用于记录c++基础知识，后面再排版，学习资料来自狄泰软件学院可在淘宝购买学习">
<meta property="og:type" content="article">
<meta property="og:title" content="c++基础知识">
<meta property="og:url" content="https://example.com/2020/02/05/c++%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/index.html">
<meta property="og:site_name" content="braon-z&#39;s blog">
<meta property="og:description" content="用于记录c++基础知识，后面再排版，学习资料来自狄泰软件学院可在淘宝购买学习">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://myblog-1259396478.cos.ap-chengdu.myqcloud.com/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/c%2B%2B/1.png">
<meta property="article:published_time" content="2020-02-05T04:14:17.000Z">
<meta property="article:modified_time" content="2021-08-30T07:18:59.251Z">
<meta property="article:author" content="braon-z">
<meta property="article:tag" content="基础知识">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://myblog-1259396478.cos.ap-chengdu.myqcloud.com/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/c%2B%2B/1.png">


<link rel="canonical" href="https://example.com/2020/02/05/c++%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>
<title>c++基础知识 | braon-z's blog</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">braon-z's blog</h1>
      <i class="logo-line"></i>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
        <li class="menu-item menu-item-commonweal"><a href="/404/" rel="section"><i class="fa fa-heartbeat fa-fw"></i>公益 404</a></li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup"><div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off" maxlength="80"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close" role="button">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div class="search-result-container no-result">
  <div class="search-result-icon">
    <i class="fa fa-spinner fa-pulse fa-5x"></i>
  </div>
</div>

    </div>
  </div>

</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-nav-active sidebar-toc-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
            <div class="post-toc animated"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#const-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="nav-text">const 关键字</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81c-%E5%9C%A8c%E7%9A%84%E5%9F%BA%E7%A1%80%E4%B8%8A%E5%AF%B9const%E5%81%9A%E4%BA%86%E8%BF%9B%E5%8C%96%E5%A4%84%E7%90%86"><span class="nav-text">1、c++在c的基础上对const做了进化处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E7%AC%A6%E5%8F%B7%E8%A1%A8"><span class="nav-text">2、符号表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81c-%E4%B8%AD%E7%9A%84const%E4%B8%8E%E5%AE%8F%E5%AE%9A%E4%B9%89%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">3、c++中的const与宏定义的区别</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B8%83%E5%B0%94%E7%B1%BB%E5%9E%8B"><span class="nav-text">布尔类型</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%8D%A0%E7%94%A8%E5%86%85%E5%AD%98"><span class="nav-text">1、占用内存</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%8F%96%E5%80%BC%EF%BC%9A-true-%E5%92%8C-false"><span class="nav-text">2、取值： true 和 false</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E5%B8%83%E5%B0%94%E7%B1%BB%E5%9E%8B%E6%98%AFc-%E4%B8%AD%E7%9A%84%E5%9F%BA%E7%A1%80%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="nav-text">3、布尔类型是c++中的基础数据类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#C-%E4%B8%AD%E7%9A%84%E5%BC%95%E7%94%A8"><span class="nav-text">C++中的引用</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%8F%98%E9%87%8F%E5%90%8D"><span class="nav-text">1、变量名</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%BC%95%E7%94%A8"><span class="nav-text">2、引用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E5%BC%95%E7%94%A8%E7%9A%84%E6%84%8F%E4%B9%89"><span class="nav-text">3、引用的意义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81%E7%89%B9%E6%AE%8A%E7%9A%84%E5%BC%95%E7%94%A8%EF%BC%88const%E5%BC%95%E7%94%A8%EF%BC%89"><span class="nav-text">4、特殊的引用（const引用）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5%E3%80%81%E5%BC%95%E7%94%A8%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="nav-text">5、引用的本质</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6%E3%80%81%E4%B8%89%E7%9B%AE%E8%BF%90%E7%AE%97%E7%AC%A6%EF%BC%88-a-lt-b-a-b-%EF%BC%89"><span class="nav-text">6、三目运算符（ a &lt; b ? a : b ）</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0%E7%9A%84%E9%BB%98%E8%AE%A4%E5%80%BC"><span class="nav-text">函数参数的默认值</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%87%BD%E6%95%B0%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E7%9A%84%E8%A7%84%E5%88%99"><span class="nav-text">1.函数默认参数的规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%87%BD%E6%95%B0%E5%8D%A0%E4%BD%8D%E5%8F%82%E6%95%B0"><span class="nav-text">2.函数占位参数</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD%EF%BC%88Over-load%EF%BC%89"><span class="nav-text">函数重载（Over load）</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD%EF%BC%88Function-Over-load%EF%BC%89"><span class="nav-text">1.函数重载（Function Over load）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD%E5%8F%AF%E8%83%BD%E4%BC%9A%E4%B8%8E%E4%BD%BF%E7%94%A8%E9%BB%98%E8%AE%A4%E5%8F%82%E6%95%B0%E7%9A%84%E5%87%BD%E6%95%B0%E5%86%B2%E7%AA%81%EF%BC%88c-%E7%89%B9%E6%80%A7%E5%86%B2%E5%87%BA%EF%BC%89"><span class="nav-text">2.函数重载可能会与使用默认参数的函数冲突（c++特性冲出）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E7%BC%96%E8%AF%91%E5%99%A8%E8%B0%83%E7%94%A8%E9%87%8D%E8%BD%BD%E5%87%BD%E6%95%B0%E7%9A%84%E7%9A%84%E8%A7%84%E5%88%99"><span class="nav-text">3.编译器调用重载函数的的规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%87%BD%E6%95%B0%E9%87%8D%E8%BD%BD%E7%9A%84%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-text">4.函数重载的注意事项</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E9%87%8D%E8%BD%BD%E4%B8%8E%E6%8C%87%E9%92%88"><span class="nav-text">5.重载与指针</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-c-%E5%92%8Cc%E7%9B%B8%E4%BA%92%E8%B0%83%E7%94%A8"><span class="nav-text">6.c++和c相互调用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E5%86%85%E5%AD%98"><span class="nav-text"> 动态分配内存</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-c-%E4%B8%AD%E7%9A%84%E5%8A%A8%E6%80%81%E5%88%86%E9%85%8D%E5%86%85%E5%AD%98"><span class="nav-text">1.c++中的动态分配内存</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-new-%E5%85%B3%E9%94%AE%E5%AD%97%E4%B8%8E-mallloc-%E5%87%BD%E6%95%B0%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">2.new 关键字与 mallloc 函数的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-new%E5%85%B3%E9%94%AE%E5%AD%97%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-text">3.new关键字的初始化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-c-%E4%B8%AD%E7%9A%84%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4"><span class="nav-text">4.c++中的命名空间</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%B0%E5%9E%8B%E7%9A%84%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E6%96%B9%E5%BC%8F"><span class="nav-text">新型的类型转换方式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-C%E8%AF%AD%E8%A8%80%E4%B8%AD%E7%9A%84%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="nav-text">1.C语言中的强制类型转换</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-c-%E5%B0%86%E5%BC%BA%E5%88%B6%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%88%86%E4%B8%BA4%E7%A7%8D%E4%B8%8D%E5%90%8C%E7%9A%84%E7%B1%BB%E5%9E%8B"><span class="nav-text">2.c++将强制类型转换分为4种不同的类型</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%B3%E4%BA%8Econst%E7%9A%84%E7%96%91%E9%97%AE"><span class="nav-text">关于const的疑问</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-const%E5%B8%B8%E9%87%8F%E7%9A%84%E8%BE%A8%E5%88%AB%E6%A0%87%E5%87%86"><span class="nav-text">1.const常量的辨别标准</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E5%BC%95%E7%94%A8%E4%B8%8E%E6%8C%87%E9%92%88"><span class="nav-text">2.引用与指针</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%BF%9B%E9%98%B6%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="nav-text">进阶面向对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="nav-text">1.面向对象的基本概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1"><span class="nav-text">2.类和对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E7%B1%BB%E5%92%8C%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%84%8F%E4%B9%89"><span class="nav-text">3.类和对象的意义</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E4%B8%80%E4%BA%9B%E6%9C%89%E8%B6%A3%E7%9A%84%E9%97%AE%E9%A2%98"><span class="nav-text">4.一些有趣的问题</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E7%B1%BB%E4%B9%8B%E9%97%B4%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%85%B3%E7%B3%BB"><span class="nav-text">5.类之间的基本关系</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B1%BB%E4%B8%8E%E5%B0%81%E8%A3%85%E7%9A%84%E6%A6%82%E5%BF%B5"><span class="nav-text">类与封装的概念</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E7%B1%BB%E9%80%9A%E5%B8%B8%E5%88%86%E4%B8%BA%E4%B8%A4%E4%B8%AA%E9%83%A8%E5%88%86"><span class="nav-text">1.类通常分为两个部分</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E7%B1%BB%E7%9A%84%E5%B0%81%E8%A3%85"><span class="nav-text">2.类的封装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-C-%E4%B8%AD%E7%B1%BB%E7%9A%84%E5%B0%81%E8%A3%85"><span class="nav-text">3.C++中类的封装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E7%B1%BB%E6%88%90%E5%91%98%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="nav-text">4.类成员的作用域</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B1%BB%E7%9A%84%E7%9C%9F%E6%AD%A3%E5%BD%A2%E6%80%81"><span class="nav-text">类的真正形态</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-C-%E4%BD%BF%E7%94%A8class%E5%85%B3%E9%94%AE%E5%AD%97%E5%AE%9A%E4%B9%89%E7%B1%BB"><span class="nav-text">1.C++使用class关键字定义类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-C-%E7%9A%84%E7%B1%BB%E6%94%AF%E6%8C%81%E5%A3%B0%E6%98%8E%E5%92%8C%E5%AE%9E%E7%8E%B0%E7%9A%84%E5%88%86%E7%A6%BB"><span class="nav-text">2.C++的类支持声明和实现的分离</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E7%B1%BB%E5%AE%9E%E4%BE%8B"><span class="nav-text">3.类实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%9E%84%E9%80%A0"><span class="nav-text">对象的构造</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%9C%AC%E8%B4%A8"><span class="nav-text">1、对象的本质</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="nav-text">2、对象的初始化</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81-%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-text">3、 构造函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%EF%BC%89%E5%B8%A6%E6%9C%89%E5%8F%82%E6%95%B0%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-text">1）带有参数的构造函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%EF%BC%89%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E7%9A%84%E8%B0%83%E7%94%A8"><span class="nav-text">2）构造函数的调用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%EF%BC%89%E5%B0%8F%E5%AE%9E%E4%BE%8B"><span class="nav-text">3）小实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81%E7%89%B9%E6%AE%8A%E7%9A%84%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-text">4、特殊的构造函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%EF%BC%89%E6%97%A0%E6%83%A8%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-text">1）无惨构造函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%EF%BC%89%E6%8B%B7%E8%B4%9D%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0"><span class="nav-text">2）拷贝构造函数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#a-%E6%B5%85%E6%8B%B7%E8%B4%9D"><span class="nav-text">a. 浅拷贝</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#b-%E6%B7%B1%E6%8B%B7%E8%B4%9D"><span class="nav-text">b. 深拷贝</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%EF%BC%89%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E9%9C%80%E8%A6%81%E6%B7%B1%E6%8B%B7%E8%B4%9D"><span class="nav-text">3）什么时候需要深拷贝</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4%EF%BC%89%E6%95%B0%E7%BB%84%E7%B1%BB%E7%9A%84%E6%94%B9%E8%BF%9B"><span class="nav-text">4）数组类的改进</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%97%E8%A1%A8"><span class="nav-text">初始化列表</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%E5%88%97%E8%A1%A8%E7%9A%84%E5%88%9D%E5%A7%8B%E9%A1%BA%E5%BA%8F"><span class="nav-text">1、初始化列表的初始顺序</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E7%B1%BB%E4%B8%AD%E7%9A%84const%E6%88%90%E5%91%98"><span class="nav-text">2、类中的const成员</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%9E%84%E9%80%A0%E9%A1%BA%E5%BA%8F"><span class="nav-text">对象的构造顺序</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E9%94%80%E6%AF%81"><span class="nav-text">对象的销毁</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%B4%E6%97%B6%E5%AF%B9%E8%B1%A1"><span class="nav-text">临时对象</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E4%B8%B4%E6%97%B6%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%BA%A7%E7%94%9F"><span class="nav-text">1、临时对象的产生</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E4%B8%B4%E6%97%B6%E5%AF%B9%E8%B1%A1%E7%9A%84%E4%BC%98%E5%8C%96"><span class="nav-text">2、临时对象的优化</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%8F%E5%85%B8%E9%97%AE%E9%A2%98%E5%88%86%E6%9E%90"><span class="nav-text">经典问题分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E4%B8%8E%E6%9E%90%E6%9E%84%E5%87%BD%E6%95%B0%E7%9A%84%E8%B0%83%E7%94%A8%E9%A1%BA%E5%BA%8F"><span class="nav-text">1、构造函数与析构函数的调用顺序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%EF%BC%89%E5%8D%95%E4%B8%AA%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E6%97%B6"><span class="nav-text">1）单个对象创建时</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%EF%BC%89%E6%A0%88%E5%AF%B9%E8%B1%A1%E5%92%8C%E5%85%A8%E5%B1%80%E5%AF%B9%E8%B1%A1"><span class="nav-text">2）栈对象和全局对象</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3%EF%BC%89%E5%A0%86%E5%AF%B9%E8%B1%A1"><span class="nav-text">3）堆对象</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81const%E5%AF%B9%E8%B1%A1"><span class="nav-text">2、const对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%EF%BC%89C-%E4%B8%AD%E7%9A%84const%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0"><span class="nav-text">1）C++中的const成员函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%9E%84%E6%88%90"><span class="nav-text">3、对象的构成</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B1%BB%E7%9A%84%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F%E4%B8%8E%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0"><span class="nav-text">类的静态成员变量与成员函数</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E7%B1%BB%E7%9A%84%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E5%8F%98%E9%87%8F"><span class="nav-text">1、类的静态成员变量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E7%B1%BB%E7%9A%84%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0"><span class="nav-text">2、类的静态成员函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1%EF%BC%89%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="nav-text">1）静态成员函数的定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2%EF%BC%89%E6%99%AE%E9%80%9A%E4%B8%8E%E9%9D%99%E6%80%81%E6%88%90%E5%91%98%E5%87%BD%E6%95%B0%E5%AF%B9%E6%AF%94"><span class="nav-text">2）普通与静态成员函数对比</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E3%80%81%E5%B0%8F%E5%AE%9E%E4%BE%8B"><span class="nav-text">3、小实例</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E9%98%B6%E6%9E%84%E9%80%A0%E6%A8%A1%E5%BC%8F"><span class="nav-text">二阶构造模式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%8D%8A%E6%88%90%E5%93%81%E5%AF%B9%E8%B1%A1"><span class="nav-text">1、半成品对象</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%88%92%E5%88%86%E6%9E%84%E9%80%A0%E8%BF%87%E7%A8%8B"><span class="nav-text">2、划分构造过程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4%E3%80%81%E4%BA%8C%E9%98%B6%E6%9E%84%E9%80%A0%E7%A4%BA%E4%BE%8B"><span class="nav-text">4、二阶构造示例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BC%98%E5%8C%96%E6%95%B0%E7%BB%84%E7%B1%BB%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="nav-text">优化数组类的实现</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%A2%AB%E9%81%97%E5%BC%83%E7%9A%84%E5%8F%8B%E5%85%83"><span class="nav-text">被遗弃的友元</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B1%BB%E4%B8%AD%E7%9A%84%E9%87%8D%E8%BD%BD"><span class="nav-text">类中的重载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6%E9%87%8D%E8%BD%BD"><span class="nav-text">操作符重载</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E5%A4%8D%E6%95%B0%E7%B1%BB"><span class="nav-text">实现一个复数类</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#C-%E6%A0%87%E5%87%86%E5%BA%93"><span class="nav-text">C++标准库</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81C-%E7%BC%96%E8%AF%91%E7%8E%AF%E5%A2%83%E7%9A%84%E7%BB%84%E6%88%90"><span class="nav-text">1、C++编译环境的组成</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81C-%E6%A0%87%E5%87%86%E5%BA%93%E9%A2%84%E5%AE%9A%E4%B9%89%E4%BA%86%E5%A4%9A%E6%95%B0%E5%B8%B8%E7%94%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84"><span class="nav-text">2、C++标准库预定义了多数常用的数据结构</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#C-%E4%B8%AD%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB"><span class="nav-text">C++中的字符串类</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%95%B0%E7%BB%84%E6%93%8D%E4%BD%9C%E7%AC%A6%E7%9A%84%E9%87%8D%E8%BD%BD"><span class="nav-text">数组操作符的重载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%8F%E5%85%B8%E9%97%AE%E9%A2%98%E8%A7%A3%E6%9E%90"><span class="nav-text">经典问题解析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E3%80%81%E5%85%B3%E4%BA%8E%E8%B5%8B%E5%80%BC%E7%9A%84%E7%96%91%E9%97%AE"><span class="nav-text">1、关于赋值的疑问</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E3%80%81%E5%85%B3%E4%BA%8Estring%E7%9A%84%E7%96%91%E9%97%AE"><span class="nav-text">2、关于string的疑问</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%99%BA%E8%83%BD%E6%8C%87%E9%92%88"><span class="nav-text">智能指针</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%80%BB%E8%BE%91%E6%93%8D%E4%BD%9C%E7%AC%A6%E7%9A%84%E9%99%B7%E9%98%B1"><span class="nav-text">逻辑操作符的陷阱</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E9%80%97%E5%8F%B7%E8%A1%A8%E8%BE%BE%E5%BC%8F%E7%9A%84%E9%87%8D%E8%BD%BD"><span class="nav-text">逗号表达式的重载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%89%8D%E7%BD%AE%E6%93%8D%E4%BD%9C%E7%AC%A6%E4%B8%8E%E5%90%8E%E7%BD%AE%E6%93%8D%E4%BD%9C%E7%AC%A6%E7%9A%84%E9%87%8D%E8%BD%BD"><span class="nav-text">前置操作符与后置操作符的重载</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2%E5%87%BD%E6%95%B0"><span class="nav-text">类型转换函数</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E6%84%8F%E4%B9%89"><span class="nav-text">继承的概念和意义</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF%E4%B8%AD%E7%9A%84%E8%AE%BF%E9%97%AE%E7%BA%A7%E5%88%AB"><span class="nav-text">继承中的访问级别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89%E7%B1%BB%E6%97%B6%E8%AE%BF%E9%97%AE%E7%BA%A7%E5%88%AB%E7%9A%84%E9%80%89%E6%8B%A9"><span class="nav-text">定义类时访问级别的选择</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%8D%E5%90%8C%E7%9A%84%E7%BB%A7%E6%89%BF%E6%96%B9%E5%BC%8F"><span class="nav-text">不同的继承方式</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%BB%A7%E6%89%BF%E4%B8%AD%E7%9A%84%E6%9E%84%E9%80%A0%E4%B8%8E%E6%9E%90%E6%9E%84"><span class="nav-text">继承中的构造与析构</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%88%B6%E5%AD%90%E9%97%B4%E7%9A%84%E5%86%B2%E7%AA%81"><span class="nav-text">父子间的冲突</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%A4%9A%E6%80%81%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E6%84%8F%E4%B9%89"><span class="nav-text">多态的概念和意义</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B"><span class="nav-text">对象模型</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%9C%AA%E5%AE%8C%E5%BE%85%E7%BB%AD%E2%80%A6"><span class="nav-text">未完待续…..</span></a></li></ol></div>
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="braon-z"
      src="/images/wallhaven.jfif">
  <p class="site-author-name" itemprop="name">braon-z</p>
  <div class="site-description" itemprop="description"> 爱一个人，攀一座山，追一次梦<br>不妨大胆一点，有很多事没有答案</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">1</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author site-overview-item animated">
      <span class="links-of-author-item">
        <a href="https://github.com/yourname" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;yourname" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:yourname@gmail.com" title="E-Mail → mailto:yourname@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>


<div style="">
  <canvas id="canvas" style="width:60%;">当前浏览器不支持canvas，请更换浏览器后再试</canvas>
</div>
<script>
(function(){

   var digit=
    [
        [
            [0,0,1,1,1,0,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,0,1,1,0],
            [0,0,1,1,1,0,0]
        ],//0
        [
            [0,0,0,1,1,0,0],
            [0,1,1,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [1,1,1,1,1,1,1]
        ],//1
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,1,1],
            [1,1,1,1,1,1,1]
        ],//2
        [
            [1,1,1,1,1,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//3
        [
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,0],
            [0,0,1,1,1,1,0],
            [0,1,1,0,1,1,0],
            [1,1,0,0,1,1,0],
            [1,1,1,1,1,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,1,1]
        ],//4
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,1,1,1,1,0],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//5
        [
            [0,0,0,0,1,1,0],
            [0,0,1,1,0,0,0],
            [0,1,1,0,0,0,0],
            [1,1,0,0,0,0,0],
            [1,1,0,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//6
        [
            [1,1,1,1,1,1,1],
            [1,1,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,0,0,1,1,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0],
            [0,0,1,1,0,0,0]
        ],//7
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,1,1,0]
        ],//8
        [
            [0,1,1,1,1,1,0],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [1,1,0,0,0,1,1],
            [0,1,1,1,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,0,1,1],
            [0,0,0,0,1,1,0],
            [0,0,0,1,1,0,0],
            [0,1,1,0,0,0,0]
        ],//9
        [
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0],
            [0,0,0,0,0,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,1,1,1,0,0],
            [0,0,0,0,0,0,0]
        ]//:
    ];

var canvas = document.getElementById('canvas');

if(canvas.getContext){
    var cxt = canvas.getContext('2d');
    //声明canvas的宽高
    var H = 100,W = 700;
    canvas.height = H;
    canvas.width = W;
    cxt.fillStyle = '#f00';
    cxt.fillRect(10,10,50,50);

    //存储时间数据
    var data = [];
    //存储运动的小球
    var balls = [];
    //设置粒子半径
    var R = canvas.height/20-1;
    (function(){
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成
        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
    })();

    /*生成点阵数字*/
    function renderDigit(index,num){
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    cxt.beginPath();
                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);
                    cxt.closePath();
                    cxt.fill();
                }
            }
        }
    }

    /*更新时钟*/
    function updateDigitTime(){
        var changeNumArray = [];
        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());
        var NewData = [];
        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);
        for(var i = data.length-1; i >=0 ; i--){
            //时间发生变化
            if(NewData[i] !== data[i]){
                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中
                changeNumArray.push(i+'_'+(Number(data[i])+1)%10);
            }
        }
        //增加小球
        for(var i = 0; i< changeNumArray.length; i++){
            addBalls.apply(this,changeNumArray[i].split('_'));
        }
        data = NewData.concat();
    }

    /*更新小球状态*/
    function updateBalls(){
        for(var i = 0; i < balls.length; i++){
            balls[i].stepY += balls[i].disY;
            balls[i].x += balls[i].stepX;
            balls[i].y += balls[i].stepY;
            if(balls[i].x > W + R || balls[i].y > H + R){
                balls.splice(i,1);
                i--;
            }
        }
    }

    /*增加要运动的小球*/
    function addBalls(index,num){
        var numArray = [1,2,3];
        var colorArray =  ["#3BE","#09C","#A6C","#93C","#9C0","#690","#FB3","#F80","#F44","#C00"];
        for(var i = 0; i < digit[num].length; i++){
            for(var j = 0; j < digit[num][i].length; j++){
                if(digit[num][i][j] == 1){
                    var ball = {
                        x:14*(R+2)*index + j*2*(R+1)+(R+1),
                        y:i*2*(R+1)+(R+1),
                        stepX:Math.floor(Math.random() * 4 -2),
                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],
                        color:colorArray[Math.floor(Math.random()*colorArray.length)],
                        disY:1
                    };
                    balls.push(ball);
                }
            }
        }
    }

    /*渲染*/
    function render(){
        //重置画布宽度，达到清空画布的效果
        canvas.height = 100;
        //渲染时钟
        for(var i = 0; i < data.length; i++){
            renderDigit(i,data[i]);
        }
        //渲染小球
        for(var i = 0; i < balls.length; i++){
            cxt.beginPath();
            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);
            cxt.fillStyle = balls[i].color;
            cxt.closePath();
            cxt.fill();
        }
    }

    clearInterval(oTimer);
    var oTimer = setInterval(function(){
        //更新时钟
        updateDigitTime();
        //更新小球状态
        updateBalls();
        //渲染
        render();
    },50);
}

})();
</script>
        </div>
      </div>
        <div class="back-to-top animated" role="button">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner post posts-expand">


  


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://example.com/2020/02/05/c++%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/wallhaven.jfif">
      <meta itemprop="name" content="braon-z">
      <meta itemprop="description" content=" 爱一个人，攀一座山，追一次梦<br>不妨大胆一点，有很多事没有答案">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="braon-z's blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          c++基础知识
        </h1>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2020-02-05 12:14:17" itemprop="dateCreated datePublished" datetime="2020-02-05T12:14:17+08:00">2020-02-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-08-30 15:18:59" itemprop="dateModified" datetime="2021-08-30T15:18:59+08:00">2021-08-30</time>
      </span>

  
    <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="far fa-eye"></i>
      </span>
      <span class="post-meta-item-text">阅读次数：</span>
      <span id="busuanzi_value_page_pv"></span>
    </span>
  
  <span class="post-meta-item">
    
    <span class="post-meta-item-icon">
      <i class="far fa-comment"></i>
    </span>
    <span class="post-meta-item-text">Valine：</span>
  
    <a title="valine" href="/2020/02/05/c++%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/#valine-comments" itemprop="discussionUrl">
      <span class="post-comments-count valine-comment-count" data-xid="/2020/02/05/c++%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" itemprop="commentCount"></span>
    </a>
  </span>
  
  
      </div>
      <div class="post-meta">
    <span class="post-meta-item" title="本文字数">
      <span class="post-meta-item-icon">
        <i class="far fa-file-word"></i>
      </span>
      <span class="post-meta-item-text">本文字数：</span>
      <span>56k</span>
    </span>
    <span class="post-meta-item" title="阅读时长">
      <span class="post-meta-item-icon">
        <i class="far fa-clock"></i>
      </span>
      <span class="post-meta-item-text">阅读时长 &asymp;</span>
      <span>51 分钟</span>
    </span>
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
        <p>用于记录c++基础知识，后面再排版，学习资料来自狄泰软件学院可在淘宝购买学习</p>
<a id="more"></a>
<h1 id="const-关键字"><a href="#const-关键字" class="headerlink" title="const 关键字"></a><div align=center>const 关键字</h1><h2 id="1、c-在c的基础上对const做了进化处理"><a href="#1、c-在c的基础上对const做了进化处理" class="headerlink" title="1、c++在c的基础上对const做了进化处理"></a>1、c++在c的基础上对const做了进化处理</h2><ul>
<li><strong>当碰见const声明时，在符号表中放入常量</strong></li>
<li><strong>编译过程中发现使用常量则直接以符号表中的值替换</strong></li>
<li><strong>编译过程如发现下述情况则给对应的常量分配储存空间</strong><br>&nbsp; &nbsp;&nbsp;对const全局常量使用 extern<br>&nbsp; &nbsp;&nbsp;对const常量使用 &amp; 操作符</li>
<li>*注意**<br>c++编译器虽然可能会为 const 常量分配空间，但不会使用空间中的值。<h2 id="2、符号表"><a href="#2、符号表" class="headerlink" title="2、符号表"></a>2、符号表</h2>编译器在编译的过程当中所产生的一张表，是编译器内部的数据结构<img width=600 src="https://myblog-1259396478.cos.ap-chengdu.myqcloud.com/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/c%2B%2B/1.png" >

</li>
</ul>
<p><strong>c++中const常量类似于宏定义</strong><br>&nbsp; &nbsp;&nbsp;const int c = 5; ≈ #define c 5</p>
<h2 id="3、c-中的const与宏定义的区别"><a href="#3、c-中的const与宏定义的区别" class="headerlink" title="3、c++中的const与宏定义的区别"></a>3、c++中的const与宏定义的区别</h2><p>const 常量是<strong>被编译器处理</strong><br>编译器对const常亮进行<strong>类型检查</strong>和<strong>作用域检查</strong><br>宏定义由<strong>预处理器处理</strong>，是<strong>单纯的文本替换</strong><br>宏<strong>没有类型以及作用域的概念</strong>， const 有<strong>作用域和类型的概念</strong></p>
<h1 id="布尔类型"><a href="#布尔类型" class="headerlink" title="布尔类型"></a><div align=center>布尔类型</h1><h2 id="1、占用内存"><a href="#1、占用内存" class="headerlink" title="1、占用内存"></a>1、占用内存</h2><p>一个字节</p>
<h2 id="2、取值：-true-和-false"><a href="#2、取值：-true-和-false" class="headerlink" title="2、取值： true 和 false"></a>2、取值： true 和 false</h2><p>true    ： 代表真值，编译器内部用 1 表示<br>false    ： 代表非真值，编译器内部用 0 表示<br>c++编译器会将非0值转换为 true ， 0 值转换为 false</p>
<h2 id="3、布尔类型是c-中的基础数据类型"><a href="#3、布尔类型是c-中的基础数据类型" class="headerlink" title="3、布尔类型是c++中的基础数据类型"></a>3、布尔类型是c++中的基础数据类型</h2><p>可以定义bool类型的<strong>全局变量</strong><br>可以定义bool类型的<strong>常量</strong><br>可以定义bool类型的<strong>指针</strong><br>可以定义bool类型的<strong>数组</strong><br>…</p>
<h1 id="C-中的引用"><a href="#C-中的引用" class="headerlink" title="C++中的引用"></a><div align=center>C++中的引用</h1><h2 id="1、变量名"><a href="#1、变量名" class="headerlink" title="1、变量名"></a>1、变量名</h2><p>  变量是一段实际连续存储空间的别名<br>  程序中通过变量来申请并命名存储空间<br>  通过变量的名字可以使用存储空间</p>
<h2 id="2、引用"><a href="#2、引用" class="headerlink" title="2、引用"></a>2、引用</h2><p>引用可以看作已经定义的变量的别名<br>引用的语法：type &amp; name = var ;<br>例子：</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> a = <span class="number">4</span>;</span><br><span class="line"><span class="built_in">int</span> &amp; b = a; 		<span class="comment">// b为a的别名</span></span><br><span class="line">b = <span class="number">5</span>;				<span class="comment">//操作b就是操作a</span></span><br></pre></td></tr></table></figure>
<p>注意：<br>&nbsp; &nbsp;普通引用在定义时必须用同类类型的变量进行初始化。</p>
<h2 id="3、引用的意义"><a href="#3、引用的意义" class="headerlink" title="3、引用的意义"></a>3、引用的意义</h2><p>引用做为变量的别名而存在,因此在一些场合可以代替指针<br>引用相对于指针了来说具有更好的可读性与实用性</p>
<p>swap函数对比</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>&amp; a, <span class="keyword">int</span>&amp; b)</span>					</span></span><br><span class="line"><span class="function"></span>&#123;												</span><br><span class="line">	<span class="keyword">int</span> t = a;										</span><br><span class="line">	a = b;											</span><br><span class="line">	b = t;											</span><br><span class="line">&#125;												</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">swap</span><span class="params">(<span class="keyword">int</span>* a, <span class="keyword">int</span>* b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> t = *a;</span><br><span class="line">	*a = *b;</span><br><span class="line">	*b = *t;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>注意：函数中的引用不需要初始化</strong></p>
<h2 id="4、特殊的引用（const引用）"><a href="#4、特殊的引用（const引用）" class="headerlink" title="4、特殊的引用（const引用）"></a>4、特殊的引用（const引用）</h2><p>在c++中可以声明const引用<br>语法：const type&amp; name = var;<br>const 引用让变量拥有只读属性</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> a = <span class="number">4</span>;</span><br><span class="line"><span class="keyword">const</span> <span class="built_in">int</span>&amp; b = a;</span><br><span class="line"><span class="built_in">int</span>* p = (<span class="built_in">int</span>*)&amp;b;</span><br><span class="line"></span><br><span class="line">b = <span class="number">5</span>;			<span class="comment">// Error , 只读变量</span></span><br><span class="line">*p = <span class="number">5</span>;		    <span class="comment">//ok, 修改变量a的值</span></span><br></pre></td></tr></table></figure>
<p>当使用常量对const引用进行初始化时，c++编译器会为常量值分配空间，并将引用名作为这段空间的别名</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="built_in">int</span>&amp; b = <span class="number">1</span>;		<span class="comment">//ok</span></span><br><span class="line"><span class="built_in">int</span>* p = (<span class="built_in">int</span>*) &amp;b;</span><br><span class="line">b = <span class="number">5</span>;   <span class="comment">//Error , 只读变量</span></span><br><span class="line">*p = <span class="number">5</span>;  <span class="comment">//ok , 修改变量a的值</span></span><br></pre></td></tr></table></figure>
<p>结论：使用常量对const引用初始化后将得到一个只读变量<br>思考：引用有自己的存储空间吗？(有、本质为指针)</p>
<h2 id="5、引用的本质"><a href="#5、引用的本质" class="headerlink" title="5、引用的本质"></a>5、引用的本质</h2><p>引用在c++中的内部实现是一个指针常量</p>
<figure class="highlight delphi"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span>&amp; <span class="keyword">name</span>; 	 		   </span><br><span class="line"></span><br><span class="line">void f(int&amp; a)						</span><br><span class="line"><span class="comment">&#123;											</span></span><br><span class="line"><span class="comment">	a = 5;									</span></span><br><span class="line"><span class="comment">&#125;</span>										</span><br><span class="line"></span><br><span class="line"><span class="keyword">Type</span>* <span class="keyword">const</span> <span class="keyword">name</span>;</span><br><span class="line"></span><br><span class="line">void (int * <span class="keyword">const</span> a)</span><br><span class="line"><span class="comment">&#123;</span></span><br><span class="line"><span class="comment">	*a = 5;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;1) c++编译器在编译过程中用常量指针作为内部实现，因此引用所占用的内存空间大小与指针相同。<br>&nbsp; &nbsp;&nbsp; &nbsp;2) 从使用角度，引用只是一个别名，c++为了实用性而隐藏了引用的储存空间这一细节</p>
<p>C++中的引用旨在在多数情况下代替指针<br>&nbsp; &nbsp;&nbsp; &nbsp;功能性：可以满足多数需要使用指针的场合<br>&nbsp; &nbsp;&nbsp; &nbsp;安全性：可以避开大部分由于指针操作不当而带来的内存错误<br>&nbsp; &nbsp;&nbsp; &nbsp;操作性：简单易用，又不失功能强大</p>
<p><strong>绝对不要返回动态局部变量的引用</strong></p>
<h2 id="6、三目运算符（-a-lt-b-a-b-）"><a href="#6、三目运算符（-a-lt-b-a-b-）" class="headerlink" title="6、三目运算符（ a &lt; b ? a : b ）"></a>6、三目运算符（ a &lt; b ? a : b ）</h2><p>c语言中的三目运算符返回的是变量值<strong>不能作为左值使用</strong><br>c++中三目运算符可直接返回变量本身<strong>即可作为右值，也可作为左值使用</strong></p>
<p>注意：<br>&nbsp; &nbsp;&nbsp; &nbsp;三目运算符可能返回值的值如果有一个值是常量值，则不能作为左值使用</p>
<p>总结：<br>&nbsp; &nbsp;&nbsp; &nbsp;当三目运算符的可能返回都是变量时，返回的是变量的引用<br>&nbsp; &nbsp;&nbsp; &nbsp;当三目运算符可能返回的值中有常量时，返回是变量的值</p>
<p>例子：</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">int a = <span class="number">0</span>;</span><br><span class="line">int <span class="keyword">b </span>= <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">( a &lt; <span class="keyword">b? </span>a : <span class="keyword">b) </span>= <span class="number">3</span><span class="comment">;	//正确，返回a或b的引用，可做左值</span></span><br><span class="line">( a &lt; <span class="keyword">b? </span>a : <span class="number">1</span>) = <span class="number">3</span><span class="comment">;	//错误，返回1或b的值，不可做左值</span></span><br></pre></td></tr></table></figure>
<h1 id="函数参数的默认值"><a href="#函数参数的默认值" class="headerlink" title="函数参数的默认值"></a><div align=center>函数参数的默认值</h1><p>C++可以在函数声明时为参数提供一个默认值<br>当函数调用时没有提供参数的值，则使用默认值 </p>
<h2 id="1-函数默认参数的规则"><a href="#1-函数默认参数的规则" class="headerlink" title="1.函数默认参数的规则"></a>1.函数默认参数的规则</h2><p>函数默认参数指定方式</p>
<blockquote>
<p>函数参数的默认值<strong>在函数声明中指定</strong>,多使用这种方式</p>
</blockquote>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a = <span class="number">0</span>)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>函数参数的默认值<strong>在函数定义中指定</strong>，很少或不建议使用</p>
</blockquote>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a)</span></span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> a = <span class="number">0</span>)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>设计函数时，参数的默认值必须从右向左提供<br>函数调用时使用了默认值，则后续参数必须使用默认值<br>调用函数时，从左向右匹配</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="built_in">int</span> <span class="title">add</span>(<span class="params"> <span class="built_in">int</span> x, <span class="built_in">int</span> y = <span class="number">1</span>, <span class="built_in">int</span> z = <span class="number">2</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> x + y + z;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">add</span>(<span class="number">0</span>);			<span class="comment">// x = 0, y = 1, z = 2</span></span><br><span class="line"><span class="keyword">add</span>(<span class="number">2</span>,<span class="number">3</span>);		<span class="comment">// x = 2, y = 3, z = 2</span></span><br><span class="line"><span class="keyword">add</span>(<span class="number">3</span>,<span class="number">2</span>,<span class="number">1</span>);		<span class="comment">// x = 3, y = 2, z = 1</span></span><br></pre></td></tr></table></figure>
<h2 id="2-函数占位参数"><a href="#2-函数占位参数" class="headerlink" title="2.函数占位参数"></a>2.函数占位参数</h2><p>在c++中可以为函数提供占位参数<br>占位参数只有参数类型声明，而没有参数申明<br>一般情况下，在函数体内部无法使用占位参数</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span> x , <span class="keyword">int</span>)</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span><span class="params">(1,2)</span>;		//<span class="title">ok</span></span></span><br></pre></td></tr></table></figure>
<p>占位参数与默认参数结合起来使用,兼容c语言程序中可能出现的不规范写法</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">c: void <span class="function"><span class="title">fun</span><span class="params">()</span></span>  &lt;----&gt; c++: void <span class="function"><span class="title">fun</span><span class="params">(int = <span class="number">0</span>)</span></span></span><br></pre></td></tr></table></figure>
<h1 id="函数重载（Over-load）"><a href="#函数重载（Over-load）" class="headerlink" title="函数重载（Over load）"></a><div align=center>函数重载（Over load）</h1><p>同一个标识符在不同的上下文有不同的意义，高级语言无限接近自然语言，重载来自于自然语言的动词+名词。</p>
<h2 id="1-函数重载（Function-Over-load）"><a href="#1-函数重载（Function-Over-load）" class="headerlink" title="1.函数重载（Function Over load）"></a>1.函数重载（Function Over load）</h2><p>用同一个函数名定义不同的函数,当函数名和不同的参数搭配时函数的含义不同<br>函数重载必须至少满足下面一个条件;<strong>参数的个数不同、参数的类型不同、参数的顺序不同</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span> x)</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span> a, <span class="keyword">const</span> char* s)</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> strlen(s);</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">const</span> char* s, <span class="keyword">int</span> a)</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> strlen(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-函数重载可能会与使用默认参数的函数冲突（c-特性冲出）"><a href="#2-函数重载可能会与使用默认参数的函数冲突（c-特性冲出）" class="headerlink" title="2.函数重载可能会与使用默认参数的函数冲突（c++特性冲出）"></a>2.函数重载可能会与使用默认参数的函数冲突（c++特性冲出）</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="function"><span class="keyword">func</span><span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span> c = 5)</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> a * b * c;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="function"><span class="keyword">func</span><span class="params">( <span class="keyword">int</span> a, <span class="keyword">int</span> b)</span></span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="3-编译器调用重载函数的的规则"><a href="#3-编译器调用重载函数的的规则" class="headerlink" title="3.编译器调用重载函数的的规则"></a>3.编译器调用重载函数的的规则</h2><p><strong>将所用同名函数作为候选者，尝试寻找可行的后选函数</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;精确匹配实参<br>&nbsp; &nbsp;&nbsp; &nbsp;通过默认参数能够匹配实参<br>&nbsp; &nbsp;&nbsp; &nbsp;通过默认类型转换匹配实参<br><strong>匹配失败</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;最终寻找到的候选函数不唯一，则出现二义性，编译失败<br>&nbsp; &nbsp;&nbsp; &nbsp;无法匹配所有候选者，函数未定义，编译失败</p>
<h2 id="4-函数重载的注意事项"><a href="#4-函数重载的注意事项" class="headerlink" title="4.函数重载的注意事项"></a>4.函数重载的注意事项</h2><p>重载函数在本质上是<strong>相互独立的不同函数</strong><br>重载函数的<strong>函数类型不同</strong><br>函数<strong>返回值</strong>不能作为函数重载的依据<br>函数重载是由<strong>函数名和参数列表决定！</strong></p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="keyword">add</span>(<span class="type">int</span> a, <span class="type">int</span> b)        // <span class="type">int</span> (<span class="type">int</span> ,<span class="type">int</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="keyword">add</span>(<span class="type">int</span> a, <span class="type">int</span> b,<span class="type">int</span> c)  // <span class="type">int</span> (<span class="type">int</span> ,<span class="type">int</span>,<span class="type">int</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">return</span> a + b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> main(<span class="type">int</span> argc,<span class="type">char</span>* argv[])</span><br><span class="line">&#123;</span><br><span class="line">	printf(&quot;%p\n&quot;,( <span class="type">int</span>(*)(<span class="type">int</span> ,<span class="type">int</span>))<span class="keyword">add</span>);      // <span class="number">0x8048494</span></span><br><span class="line">	printf(&quot;%p\n&quot;,( <span class="type">int</span>(*)(<span class="type">int</span> ,<span class="type">int</span>,<span class="type">int</span>))<span class="keyword">add</span>);   //<span class="number">0x80484a2</span></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="5-重载与指针"><a href="#5-重载与指针" class="headerlink" title="5.重载与指针"></a>5.重载与指针</h2><p>将重载函数名赋值给指针时<br>&nbsp; &nbsp;&nbsp; &nbsp;根据重载规则挑选与函数指针参数列表一致的候选者<br>&nbsp; &nbsp;&nbsp; &nbsp;严格匹配候选者的函数类型与函数指针的函数类型<br>注意：<br>&nbsp; &nbsp;&nbsp; &nbsp;函数重载必然发生在同一个作用域中<br>&nbsp; &nbsp;&nbsp; &nbsp;编译器需要用参数列表或函数类型进行函数选择<br>&nbsp; &nbsp;&nbsp; &nbsp;无法直接通过函数名得到重载函数的入口地址</p>
<h2 id="6-c-和c相互调用"><a href="#6-c-和c相互调用" class="headerlink" title="6.c++和c相互调用"></a>6.c++和c相互调用</h2><p>实际工程中c++和c代码相互调用是不可避免的<br>c++编译器能够兼容c语言编译方式<br>c++编译器优先使用c++编译方式<br>extern关键字强制让c++编译器进行c方式编译<br>extern 代码块中不能存在重载函数</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">extern “C”</span><br><span class="line">&#123;</span><br><span class="line">	<span class="regexp">//</span> <span class="keyword">do</span> c-style compilation here</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>保证一段c代码只会以c的方式被编译</p>
<blockquote>
<p>__cplusplus是c++编译器内置的标准宏定义<br>__cplusplus的意义是确保c代码以统一的方式被编译成目标文件</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line"><span class="keyword">extern</span> <span class="string">&quot;C&quot;</span> &#123;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">	</span><br><span class="line"><span class="comment">// C-Style Compilation</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> __cplusplus</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p><strong>注意事项</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;c++编译器不能以c的方式编译重载函数<br>&nbsp; &nbsp;&nbsp; &nbsp;编译方式决定函数名被编译后的目标名<br>&nbsp; &nbsp;&nbsp; &nbsp;c++编译方式将函数名和参数列表编译成目标名<br>&nbsp; &nbsp;&nbsp; &nbsp;c编译方式只将函数名作为目标名进行编译</p>
<h1 id="动态分配内存"><a href="#动态分配内存" class="headerlink" title=" 动态分配内存"></a><div align=center> 动态分配内存</h1><h2 id="1-c-中的动态分配内存"><a href="#1-c-中的动态分配内存" class="headerlink" title="1.c++中的动态分配内存"></a>1.c++中的动态分配内存</h2><p>c++中通过new关键字进行动态内存申请<br>c++中的动态内存申请是基于类型进行的<br>delete关键字用于释放内存</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">变量申请：								数组申请：</span><br><span class="line"></span><br><span class="line"><span class="built_in">Type</span>* Pointer = <span class="keyword">new</span> <span class="built_in">Type</span>;				<span class="built_in">Type</span>* pointer = <span class="keyword">new</span> <span class="built_in">Type</span>[N];</span><br><span class="line"><span class="comment">//......										//......</span></span><br><span class="line"><span class="keyword">delete</span> pointer;							<span class="keyword">delete</span>[] pointer;</span><br></pre></td></tr></table></figure>
<h2 id="2-new-关键字与-mallloc-函数的区别"><a href="#2-new-关键字与-mallloc-函数的区别" class="headerlink" title="2.new 关键字与 mallloc 函数的区别"></a>2.new 关键字与 mallloc 函数的区别</h2><p>new关键字是c++的一部分<br>malloc 是由c库提供的函数<br>new 以具体类型为单位进行内存分配<br>malloc 以字节为单位进行内存分配<br>new 在申请单个类型变量时可以进行初始化<br>malloc 不具备内存初始化的特性</p>
<h2 id="3-new关键字的初始化"><a href="#3-new关键字的初始化" class="headerlink" title="3.new关键字的初始化"></a>3.new关键字的初始化</h2><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span>* p = <span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">1</span>);</span><br><span class="line"><span class="keyword">float</span>* f = <span class="keyword">new</span> <span class="keyword">float</span>(<span class="number">2.0f</span>);</span><br><span class="line"><span class="keyword">char</span>* pc = <span class="keyword">new</span> <span class="keyword">char</span>(‘c’);</span><br></pre></td></tr></table></figure>
<h2 id="4-c-中的命名空间"><a href="#4-c-中的命名空间" class="headerlink" title="4.c++中的命名空间"></a>4.c++中的命名空间</h2><p>在C语言中只有一个全局作用域<br>&nbsp; &nbsp;&nbsp; &nbsp;C语言中所有标识符共享一个作用域<br>&nbsp; &nbsp;&nbsp; &nbsp;标识符之间可能发生冲突<br>C++中提出了命名空间的概念<br>&nbsp; &nbsp;&nbsp; &nbsp;命名空间将全局作用域分成不同的部分<br>&nbsp; &nbsp;&nbsp; &nbsp;命名空间可以相互嵌套<br>&nbsp; &nbsp;&nbsp; &nbsp;全局作用域也叫默认命名空间<br>&nbsp; &nbsp;&nbsp; &nbsp;无论怎么划分本质还是全局作用域</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">定义</span><br><span class="line"><span class="keyword">namespace</span> <span class="symbol">Name</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">namespace</span> <span class="symbol">Internal</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/*  ...  */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*	...  */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>命名空间的使用<br>&nbsp; &nbsp;&nbsp; &nbsp;使用整个命名空间：using namespace name;<br>&nbsp; &nbsp;&nbsp; &nbsp;使用命名空间中的变量：using name::variable;<br>&nbsp; &nbsp;&nbsp; &nbsp;使用默认命名空间中的变量：::variable;</p>
<h1 id="新型的类型转换方式"><a href="#新型的类型转换方式" class="headerlink" title="新型的类型转换方式"></a><div align=center>新型的类型转换方式</h1><h2 id="1-C语言中的强制类型转换"><a href="#1-C语言中的强制类型转换" class="headerlink" title="1.C语言中的强制类型转换"></a>1.C语言中的强制类型转换</h2><p>(type )( Expression )<br>type( Expression )<br>C强制类型转换存在问题<br>&nbsp; &nbsp;&nbsp; &nbsp;过于粗暴;任意类型之间都可以进行转换，编译器很难判断其正确性<br>&nbsp; &nbsp;&nbsp; &nbsp;难于定位;在源码中无法快速定位所有使用强制类型转换的语句</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">typedef <span class="type">void</span>(PF)(<span class="type">int</span>);</span><br><span class="line"></span><br><span class="line">sturcut <span class="type">Point</span></span><br><span class="line">&#123;	</span><br><span class="line">	<span class="type">int</span> x;</span><br><span class="line">	<span class="type">int</span> y;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> v = <span class="number">0x12345</span>;</span><br><span class="line">PF* pf = PF* (v);</span><br><span class="line"><span class="type">char</span> c = <span class="type">char</span> (v);</span><br><span class="line"><span class="type">Point</span>* p = (<span class="type">Point</span>*) v; </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="2-c-将强制类型转换分为4种不同的类型"><a href="#2-c-将强制类型转换分为4种不同的类型" class="headerlink" title="2.c++将强制类型转换分为4种不同的类型"></a>2.c++将强制类型转换分为4种不同的类型</h2><ul>
<li><strong>static_cast强制类型转换（静态类型转换）</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;用于基本类型之间的转换<br>&nbsp; &nbsp;&nbsp; &nbsp;不能用于基本类型指针间的转换<br>&nbsp; &nbsp;&nbsp; &nbsp;用于有继承关系类对象之间的转换和类指针之间的转换</li>
<li><strong>const_cast 强制类型转换</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;用于除去变量的只读属性<br>&nbsp; &nbsp;&nbsp; &nbsp;强制转换的目标类型必须是指针或引用</li>
<li><strong>reinterpret_cast 强制类型转换</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;用于指针类型间的强制转换<br>&nbsp; &nbsp;&nbsp; &nbsp;用于整数和指针类型间的强制类型转换</li>
<li><strong>dynamic_cast 强制类型转换</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;用于有继承关系的类指针间的转换<br>&nbsp; &nbsp;&nbsp; &nbsp;用于有交叉关系的类指针间的转换<br>&nbsp; &nbsp;&nbsp; &nbsp;具有类型检查功能<br>&nbsp; &nbsp;&nbsp; &nbsp;需要虚函数的支持<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">static_cast_demo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0x12345</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">    <span class="keyword">int</span>* pi = &amp;i;</span><br><span class="line">    <span class="keyword">char</span>* pc = &amp;c;</span><br><span class="line">    </span><br><span class="line">    c = <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>&gt;(i);</span><br><span class="line">    pc = <span class="keyword">static_cast</span>&lt;<span class="keyword">char</span>*&gt;(pi); <span class="comment">//ERROR 不能用于指针间的转换</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">const_cast_demo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span>&amp; j = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span>&amp; k = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span>&amp;&gt;(j);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> x = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span>&amp; y = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span>&amp;&gt;(x);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span> z = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span>&gt;(x); <span class="comment">//ERROR 目标类型必须是引用或者指针</span></span><br><span class="line">    </span><br><span class="line">    k = <span class="number">5</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;k = %d\n&quot;</span>, k);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;j = %d\n&quot;</span>, j);</span><br><span class="line">    </span><br><span class="line">    y = <span class="number">8</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x = %d\n&quot;</span>, x);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;y = %d\n&quot;</span>, y);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&amp;x = %p\n&quot;</span>, &amp;x);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&amp;y = %p\n&quot;</span>, &amp;y);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reinterpret_cast_demo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">char</span> c = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">    <span class="keyword">int</span>* pi = &amp;i;</span><br><span class="line">    <span class="keyword">char</span>* pc = &amp;c;</span><br><span class="line">    </span><br><span class="line">    pc = <span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">char</span>*&gt;(pi);</span><br><span class="line">    pi = <span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">int</span>*&gt;(pc);</span><br><span class="line">    pi = <span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">int</span>*&gt;(i);   </span><br><span class="line">    c = <span class="keyword">reinterpret_cast</span>&lt;<span class="keyword">char</span>&gt;(i); <span class="comment">// ERROR 指针与指针或指针与整数间的转换</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dynamic_cast_demo</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span>* pi = &amp;i;</span><br><span class="line">    <span class="keyword">char</span>* pc = <span class="keyword">dynamic_cast</span>&lt;<span class="keyword">char</span>*&gt;(pi); <span class="comment">//ERROR</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    static_cast_demo();</span><br><span class="line">    const_cast_demo();</span><br><span class="line">    reinterpret_cast_demo();</span><br><span class="line">    dynamic_cast_demo();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="关于const的疑问"><a href="#关于const的疑问" class="headerlink" title="关于const的疑问"></a><div align=center>关于const的疑问</h1><h2 id="1-const常量的辨别标准"><a href="#1-const常量的辨别标准" class="headerlink" title="1.const常量的辨别标准"></a>1.const常量的辨别标准</h2>在<strong>编译期间不能直接确定初始值的 const 标识符</strong>，都会被做只读变量处理<br>只有<strong>字面量初始化</strong>的 const常量才会进入符号表<br>使用其<strong>他变量初始化的 const常量仍然是只读变量</strong><br>被<strong>volatile修饰的 const常量</strong>不会进入符号表<br>const引用的类型与初始化变量的类型<br>&nbsp; &nbsp;&nbsp; &nbsp;相同：初始化变量成为只读变量<br>&nbsp; &nbsp;&nbsp; &nbsp;不同：生成一个新的只读变量<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> x = <span class="number">1</span>;      <span class="comment">//常量值进入符号表，字面量初始化</span></span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span>&amp; rx = x;    <span class="comment">//只读变量，相同类型</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">int</span>&amp; nrx = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span>&amp;&gt;(rx);  <span class="comment">//普通变量</span></span><br><span class="line">    </span><br><span class="line">    nrx = <span class="number">5</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;x = %d\n&quot;</span>, x);         <span class="comment">// 1</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;rx = %d\n&quot;</span>, rx);       <span class="comment">// 5</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;nrx = %d\n&quot;</span>, nrx);     <span class="comment">// 5</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&amp;x = %p\n&quot;</span>, &amp;x);       <span class="comment">// 0xbf8e8a88</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&amp;rx = %p\n&quot;</span>, &amp;rx);     <span class="comment">// 0xbf8e8a88</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&amp;nrx = %p\n&quot;</span>, &amp;nrx);   <span class="comment">// 0xbf8e8a88</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">volatile</span> <span class="keyword">const</span> <span class="keyword">int</span> y = <span class="number">2</span>;       <span class="comment">//只读变量</span></span><br><span class="line">    <span class="keyword">int</span>* p = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span>*&gt;(&amp;y);  </span><br><span class="line">    </span><br><span class="line">    *p = <span class="number">6</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;y = %d\n&quot;</span>, y);         <span class="comment">// 6</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;p = %p\n&quot;</span>, p);         <span class="comment">// 0xbf8e8a7c</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span> z = y;               <span class="comment">//只读变量</span></span><br><span class="line">    </span><br><span class="line">    p = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span>*&gt;(&amp;z);</span><br><span class="line">    </span><br><span class="line">    *p = <span class="number">7</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;z = %d\n&quot;</span>, z);        <span class="comment">// 7</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;p = %p\n&quot;</span>, p);        <span class="comment">// 0xbf8e8a74</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">char</span> c = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">    <span class="keyword">char</span>&amp; rc = c;</span><br><span class="line">    <span class="keyword">const</span> <span class="keyword">int</span>&amp; trc = c;           <span class="comment">//新的只读变量</span></span><br><span class="line">    </span><br><span class="line">    rc = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;c = %c\n&quot;</span>, c);        <span class="comment">// C = a</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;rc = %c\n&quot;</span>, rc);      <span class="comment">// rc = a</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;trc = %c\n&quot;</span>, trc);    <span class="comment">// trc = c</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-引用与指针"><a href="#2-引用与指针" class="headerlink" title="2.引用与指针"></a>2.引用与指针</h2></li>
<li><strong>指针</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;指针是一个变量，值为一个内存地址，不需要初始化，可以保存不同的地址，通过指针可以访问对应内存地址中的值，指针可以被const修饰成为常量或者只读变量</li>
<li><strong>引用</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;引用只是一个变量的新名字，对引用的操作（赋值，取地址等）都会传递到代表的变量上；const引用使其代表的变量具有只读属性；引用必须在定义时初始化，之后无法代表其他变量</li>
<li><strong>从c++语言的角度来看</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;引用与指针没有任何关系；引用是变量的新名字，操作引用就是操作对应的变量</li>
<li><strong>从c++编译器的角度来看</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;为了支持新概念“引用”必须要有一个有效的方案；在编译器内部，使用指针常量来实现“引用”；因此，“引用”在定义时必须初始化</li>
<li><strong>在工程项目开发中</strong><br>&nbsp; &nbsp;&nbsp; &nbsp;当c++编译时，直接站在使用的角度看待引用，与指针毫无关系，引用就是变量的别名,当对c++代码进行调试分析时，一些特殊情况，可以考虑站在c++编译器角度来看待引用</li>
<li><strong>C++不支持引用数组</strong><br>数组的本质为一段连续的内存空间，引用会打断这种连续性，c++为了更好的兼容c语言因此，c++不支持引用数组<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> a = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">SV</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">int</span>&amp; x;</span><br><span class="line">    <span class="keyword">int</span>&amp; y;</span><br><span class="line">    <span class="keyword">int</span>&amp; z;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> b = <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span>* pc = <span class="keyword">new</span> <span class="keyword">int</span>(<span class="number">3</span>);</span><br><span class="line">    SV sv = &#123;a, b, *pc&#125;;</span><br><span class="line">    <span class="keyword">int</span>&amp; <span class="built_in">array</span>[] = &#123;a, b, *pc&#125;; <span class="comment">// &amp;array[1] - &amp;array[0] = ?  Expected ==&gt; 4</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&amp;sv.x = %p\n&quot;</span>, &amp;sv.x);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&amp;sv.y = %p\n&quot;</span>, &amp;sv.y);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;&amp;sv.z = %p\n&quot;</span>, &amp;sv.z);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">delete</span> pc;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="进阶面向对象"><a href="#进阶面向对象" class="headerlink" title="进阶面向对象"></a><div align=center>进阶面向对象</h1><h2 id="1-面向对象的基本概念"><a href="#1-面向对象的基本概念" class="headerlink" title="1.面向对象的基本概念"></a>1.面向对象的基本概念</h2>面向对象的意义在于，将日常生活中习惯的思维方式引入程序设计中，将需求中的概念直观映射到解决方案中，以模块为中心构建可复用的软件系统，提高软件产品的可维护性<h2 id="2-类和对象"><a href="#2-类和对象" class="headerlink" title="2.类和对象"></a>2.类和对象</h2></li>
<li>*类：**指的一类的事物，是一个抽象的概念，类是一种模型，这种模型可以创建出不同的对象实体</li>
<li>*对象：**指的是属于某个类的具体实体，对象实体是类模型的一个具体实例<blockquote>
<p>一个类可以有很多对象，而一个 对象必然属于某个类</p>
</blockquote>
</li>
</ul>
<h2 id="3-类和对象的意义"><a href="#3-类和对象的意义" class="headerlink" title="3.类和对象的意义"></a>3.类和对象的意义</h2><p>类用于描述一类事物所特有的<font color=#DC143C size=3>属性和行为</font><br>&nbsp; &nbsp;&nbsp; &nbsp;如：电脑拥有cpu，内存和硬盘并且可以开机和运行程序<br>对象是具体的事物，拥有<font color=#DEB887 size=3>所属类中描述的一切行为和属性</font><br>&nbsp; &nbsp;&nbsp; &nbsp;如：每一只老虎都有不同的体重，不同的食量不同的性格</p>
<h2 id="4-一些有趣的问题"><a href="#4-一些有趣的问题" class="headerlink" title="4.一些有趣的问题"></a>4.一些有趣的问题</h2><p>类一定存在实际的对象吗？<br>不一定，恐龙对象不存在</p>
<p>类的对象数目是确定的吗？<br>不确定，老虎的数目不确定，皇帝类每一时期只有一个</p>
<p>类一定都是源于生活中吗？<br>不一定</p>
<p>类都是独立的吗？类之间存在关系吗？<br>不独立，类之间存在相互关系</p>
<p>对象实例一定只属于一个类吗？<br>不一定</p>
<p>对象实例可能完全相同吗？<br>不确定</p>
<h2 id="5-类之间的基本关系"><a href="#5-类之间的基本关系" class="headerlink" title="5.类之间的基本关系"></a>5.类之间的基本关系</h2><p>继承：从已存在的类细分出来的类和原类之间具有继承关系（is-a）；继承的类（子类）拥有原类（父类的所有属性和行为）<br>组合：一些类的存在必须依赖于其他的类，这种关系叫组合；组合的类在某一局部上由其他的类组成，将其他类的对象当做当前类的成员使用，当前类的对象与成员对象的生命周期相同，成员对象在用法上与普通对象完全一致</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Biology</span> &#123;</span></span><br><span class="line">    <span class="keyword">bool</span> living;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> :</span> Biology &#123;</span><br><span class="line">    <span class="keyword">bool</span> movable;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">findFood</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Plant</span> :</span> Biology &#123;</span><br><span class="line">    <span class="keyword">bool</span> growable;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Beast</span> :</span> Animal &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Human</span> :</span> Animal &#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span>&#123; &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="类与封装的概念"><a href="#类与封装的概念" class="headerlink" title="类与封装的概念"></a><div align=center>类与封装的概念</h1><h2 id="1-类通常分为两个部分"><a href="#1-类通常分为两个部分" class="headerlink" title="1.类通常分为两个部分"></a>1.类通常分为两个部分</h2><p>&nbsp; &nbsp;&nbsp; &nbsp;类的实现细节，当创建类时，才需要考虑其内部实现细节；类的使用方式，当使用类时，不需要考虑其内部的实现细节</p>
<h2 id="2-类的封装"><a href="#2-类的封装" class="headerlink" title="2.类的封装"></a>2.类的封装</h2><p>&nbsp; &nbsp;&nbsp; &nbsp;根据经验：并不是类的每个属性都是对外公开的；女孩不希望外人知道自己的体重和年龄；男孩子不希望外人知道自己的身高和收入。而一些类的属性是对外公开的；人的姓名，学历，国籍，等。因此必须在类的表示法中定义属性和行为的公开级别，类似于文件系统中的文件的权限</p>
<h2 id="3-C-中类的封装"><a href="#3-C-中类的封装" class="headerlink" title="3.C++中类的封装"></a>3.C++中类的封装</h2><p>成员变量：C++中用于表示类属性的变量<br>成员函数：C++中用于表示类行为的函数<br>C++中可以给成员变量和成员函数定义访问级别<br>&nbsp; &nbsp;&nbsp; &nbsp;Public：成员变量和成员函数可以在类的内部和外界访问调用<br>&nbsp; &nbsp;&nbsp; &nbsp;Private：成员变量和成员函数只能在类的内部被访问和调用</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Biology</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="keyword">bool</span> living;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Animal</span> :</span> Biology </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">bool</span> movable;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">findFood</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Plant</span> :</span> Biology </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">bool</span> growable;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Beast</span> :</span> Animal </span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Human</span> :</span> Animal </span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sleep</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;I&#x27;m sleeping...\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">work</span><span class="params">()</span> </span></span><br><span class="line"><span class="function">    </span>&#123; </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;I&#x27;m working...\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Girl</span> :</span> Human</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">int</span> weight;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        age = <span class="number">22</span>;</span><br><span class="line">        weight = <span class="number">48</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;I&#x27;m a girl, I&#x27;m %d years old.\n&quot;</span>, age);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;My weight is %d kg.\n&quot;</span>, weight);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Boy</span> :</span> Human</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">height</span>;</span><br><span class="line">    <span class="keyword">int</span> salary;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> age;</span><br><span class="line">    <span class="keyword">int</span> weight;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">height</span> = <span class="number">175</span>;</span><br><span class="line">        salary = <span class="number">9000</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;I&#x27;m a boy, my height is %d cm.\n&quot;</span>, <span class="built_in">height</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;My salary is %d RMB.\n&quot;</span>, salary);</span><br><span class="line">    &#125;    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Girl g;</span><br><span class="line">    Boy b;</span><br><span class="line">    </span><br><span class="line">    g.<span class="built_in">print</span>();</span><br><span class="line">    </span><br><span class="line">    b.age = <span class="number">19</span>;</span><br><span class="line">    b.weight = <span class="number">120</span>;</span><br><span class="line">    <span class="comment">//b.height = 180;  //ERROR 私有成员无法访问</span></span><br><span class="line">    </span><br><span class="line">    b.<span class="built_in">print</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="4-类成员的作用域"><a href="#4-类成员的作用域" class="headerlink" title="4.类成员的作用域"></a>4.类成员的作用域</h2><p>&nbsp; &nbsp;&nbsp; &nbsp;类成员的作用域都在类的内部外部无法直接访问；成员函数可以直接访问成员变量和调用成员函数；类的外部可以通过类变量访问public成员；类成员的作用域与访问级别没有关系（针对于外部访问）；C++中struct定义的类中的所有成员默认为public<br>&nbsp; &nbsp;&nbsp; &nbsp;想要访问类的成员变量或者成员函数都必须通过类的对象来进行，有了类的对像之后就可以访问类的成员变量和成员函数，是否访问成功还得看这个变量或者成员函数的访问级别</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getI</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        i = <span class="number">3</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">2</span>;</span><br><span class="line">    </span><br><span class="line">    Test test;</span><br><span class="line">    </span><br><span class="line">    test.j = <span class="number">4</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>, i);              <span class="comment">// i = 2;</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;::i = %d\n&quot;</span>, ::i);          <span class="comment">// ::i = 1;</span></span><br><span class="line">    <span class="comment">// printf(&quot;test.i = %d\n&quot;, test.i);    // Error</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;test.j = %d\n&quot;</span>, test.j);    <span class="comment">// test.j = 4</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;test.getI() = %d\n&quot;</span>, test.getI());  <span class="comment">// test.getI() = 3</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="类的真正形态"><a href="#类的真正形态" class="headerlink" title="类的真正形态"></a><div align=center>类的真正形态</h1><h2 id="1-C-使用class关键字定义类"><a href="#1-C-使用class关键字定义类" class="headerlink" title="1.C++使用class关键字定义类"></a>1.C++使用class关键字定义类</h2><p>在用struct定义类时，所有成员的默认访问级别为public；在使用class定义类时，所有成员的默认访问级别为private</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">A</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// defualt to public</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="comment">// defualt to public</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getI</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">B</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">    <span class="comment">// defualt to private</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="comment">// defualt to private</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getI</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    A a;</span><br><span class="line">    B b;</span><br><span class="line">    </span><br><span class="line">    a.i = <span class="number">4</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;a.getI() = %d\n&quot;</span>, a.getI());</span><br><span class="line">    </span><br><span class="line">    b.i = <span class="number">4</span>;                                 <span class="comment">//ERROR</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;b.getI() = %d\n&quot;</span>, b.getI());     <span class="comment">//ERROR</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2-C-的类支持声明和实现的分离"><a href="#2-C-的类支持声明和实现的分离" class="headerlink" title="2.C++的类支持声明和实现的分离"></a>2.C++的类支持声明和实现的分离</h2><p>将类的实现和定义分开；.h头文件中只有类的声明，成员变量和成员函数的声明；.cpp源文件中完成类的其他实现，成员函数的具体实现</p>
<h2 id="3-类实例"><a href="#3-类实例" class="headerlink" title="3.类实例"></a>3.类实例</h2><p>需求：开发一个用于四则运算的的类<br>提供setOperator函数设置运算类型<br>提供setParamater函数设置运算参数<br>提供result函数进行运算<br>&nbsp; &nbsp;&nbsp; &nbsp;其返回值表示运算的合法性<br>&nbsp; &nbsp;&nbsp; &nbsp;通过引用参数返回结果</p>
<ul>
<li><p><strong>头文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _OPERATOR_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _OPERATOR_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Operator</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">char</span> mOp;</span><br><span class="line">    <span class="keyword">double</span> mP1;</span><br><span class="line">    <span class="keyword">double</span> mP2;</span><br><span class="line">    </span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">setOperator</span><span class="params">(<span class="keyword">char</span> op)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setParameter</span><span class="params">(<span class="keyword">double</span> p1, <span class="keyword">double</span> p2)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">result</span><span class="params">(<span class="keyword">double</span>&amp; r)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></li>
<li><p><strong>类函数的具体实现</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Operator.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Operator::setOperator</span><span class="params">(<span class="keyword">char</span> op)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ret = <span class="literal">false</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">if</span>( (op == <span class="string">&#x27;+&#x27;</span>) || (op == <span class="string">&#x27;-&#x27;</span>) || (op == <span class="string">&#x27;*&#x27;</span>) || (op == <span class="string">&#x27;/&#x27;</span>) )</span><br><span class="line">    &#123;</span><br><span class="line">        ret = <span class="literal">true</span>;</span><br><span class="line">        mOp = op;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        mOp = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Operator::setParameter</span><span class="params">(<span class="keyword">double</span> p1, <span class="keyword">double</span> p2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mP1 = p1;</span><br><span class="line">    mP2 = p2;</span><br><span class="line">&#125;</span><br><span class="line">    </span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">Operator::result</span><span class="params">(<span class="keyword">double</span>&amp; r)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">bool</span> ret = <span class="literal">true</span>;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">switch</span>( mOp )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">            <span class="keyword">if</span>( (<span class="number">-0.000000001</span> &lt; mP2) &amp;&amp; (mP2 &lt; <span class="number">0.000000001</span>) )</span><br><span class="line">            &#123;</span><br><span class="line">                ret = <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                r = mP1 / mP2;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">            r = mP1 + mP2;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">            r = mP1 * mP2;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">            r = mP1 - mP2;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            ret = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>调用类的功能</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;Operator.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Operator op;</span><br><span class="line">    <span class="keyword">double</span> r = <span class="number">0</span>;</span><br><span class="line">    </span><br><span class="line">    op.setOperator(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">    op.setParameter(<span class="number">9</span>, <span class="number">3</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>( op.result(r) )</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;r = %lf\n&quot;</span>, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;Calculate error!\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="对象的构造"><a href="#对象的构造" class="headerlink" title="对象的构造"></a><div align=center>对象的构造</h1><h2 id="1、对象的本质"><a href="#1、对象的本质" class="headerlink" title="1、对象的本质"></a>1、对象的本质</h2><p>从程序设计的角度，对象只是变量，因此在<strong>栈</strong>上创建对象时，成员变量初始值为<strong>随机值</strong>、在<strong>堆</strong>上创建对象时，成员变量的初始值为<strong>随机值</strong>、在<strong>全局静态存储区</strong>创建对象时，成员变量初始值为<strong>0</strong></p>
</li>
<li><p><strong>编程实验</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">int</span> j;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getI</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> i;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getJ</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> j;&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Test gt; <span class="comment">//全局对象</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;gt.i = %d\n&quot;</span>,gt.getI());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;gt.j = %d\n&quot;</span>,gt.getJ());</span><br><span class="line"></span><br><span class="line">	Test t1; <span class="comment">//局部对象</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t1.i = %d\n&quot;</span>,t1.getI());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t1.j = %d\n&quot;</span>,t1.getJ());</span><br><span class="line"></span><br><span class="line">	Test *pt = <span class="keyword">new</span> Test; <span class="comment">//堆空间里面的零时对象</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;pt-&gt;i = %d\n&quot;</span>,pt-&gt;getI());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;pt-&gt;j = %d\n&quot;</span>,pt-&gt;getJ());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">delete</span> pt;	</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">编译结果：</span><br><span class="line">gt.i = <span class="number">0</span></span><br><span class="line">gt.j = <span class="number">0</span></span><br><span class="line">t1.i = <span class="number">-858993460</span></span><br><span class="line">t1.j = <span class="number">-858993460</span></span><br><span class="line">pt-&gt;i = <span class="number">-842150451</span></span><br><span class="line">pt-&gt;j = <span class="number">-842150451</span></span><br></pre></td></tr></table></figure>
<h2 id="2、对象的初始化"><a href="#2、对象的初始化" class="headerlink" title="2、对象的初始化"></a>2、对象的初始化</h2></li>
</ul>
<p>生活中的对象都是在初始化之后上市的，初始化状态（出厂设置）是对象普遍存在的一个状态。c++中可以定义与类名相同的特殊成员函数，这种特殊的成员函数叫做构造函数。通过构造函数可以对对象进行初始化。</p>
<h2 id="3、-构造函数"><a href="#3、-构造函数" class="headerlink" title="3、 构造函数"></a>3、 构造函数</h2><p>构造函数与类名相同并且没有返回值、构造函数没有任何返回类型的声明、构造函数在对象定义时自动被调用</p>
<p><strong>编程实验</strong><br>通过构造函数初始化对象的成员变量</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">int</span> j;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getI</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> i;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getJ</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> j;&#125;</span><br><span class="line">	Test() <span class="comment">//构造函数</span></span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">1</span>;</span><br><span class="line">		j = <span class="number">2</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Test gt; <span class="comment">//全局对象</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;gt.i = %d\n&quot;</span>,gt.getI());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;gt.j = %d\n&quot;</span>,gt.getJ());</span><br><span class="line"></span><br><span class="line">	Test t1; <span class="comment">//局部对象</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t1.i = %d\n&quot;</span>,t1.getI());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t1.j = %d\n&quot;</span>,t1.getJ());</span><br><span class="line"></span><br><span class="line">	Test *pt = <span class="keyword">new</span> Test; <span class="comment">//堆空间里面的零时对象</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;pt-&gt;i = %d\n&quot;</span>,pt-&gt;getI());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;pt-&gt;j = %d\n&quot;</span>,pt-&gt;getJ());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">delete</span> pt;	</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">gt.i = <span class="number">1</span></span><br><span class="line">gt.j = <span class="number">2</span></span><br><span class="line">t1.i = <span class="number">1</span></span><br><span class="line">t1.j = <span class="number">2</span></span><br><span class="line">pt-&gt;i = <span class="number">1</span></span><br><span class="line">pt-&gt;j = <span class="number">2</span></span><br></pre></td></tr></table></figure>
<h3 id="1）带有参数的构造函数"><a href="#1）带有参数的构造函数" class="headerlink" title="1）带有参数的构造函数"></a>1）带有参数的构造函数</h3><p>构造函数可以根据需要定义参数<br>一个类可以存在多个重载的构造函数<br>构造函数的重载遵循C++重载的规则</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">class</span> <span class="selector-tag">Test</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="attribute">public</span>:</span><br><span class="line">	<span class="built_in">Test</span>(int v)</span><br><span class="line">	&#123;</span><br><span class="line">		// use v to initialize member</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>对象定义和对象声明不同<br>对象定义-申请对象的空间并调用构造函数<br>对象声明-告诉编译器存在这样一个对象</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Test </span>t; // 定义对象并调用构造函数</span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	//告诉编译器存在名为 t 的 Test 对象</span><br><span class="line">	extern Test t;</span><br><span class="line">	</span><br><span class="line">	return 0;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>编程实验</strong><br>构造函数的自动调用<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test()\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	Test(<span class="keyword">int</span> v)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test(int v)\n&quot;</span>);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	Test t;			<span class="comment">//调用Test()</span></span><br><span class="line">	<span class="function">Test <span class="title">t1</span><span class="params">(<span class="number">1</span>)</span></span>;		<span class="comment">//调用Test(int v)</span></span><br><span class="line">	Test t2 = <span class="number">1</span>;	<span class="comment">//调用Test(int v)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">Test()</span><br><span class="line">Test(<span class="keyword">int</span> v)</span><br><span class="line">Test(<span class="keyword">int</span> v)</span><br></pre></td></tr></table></figure>
小贴士：<br>赋值与初始化是不同的<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">1</span>;	<span class="comment">//用1初始化i</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">j</span><span class="params">(<span class="number">100</span>)</span></span>;	<span class="comment">//用100初始化j</span></span><br><span class="line"></span><br><span class="line">i = <span class="number">1</span>;		<span class="comment">//赋值</span></span><br></pre></td></tr></table></figure>
<h3 id="2）构造函数的调用"><a href="#2）构造函数的调用" class="headerlink" title="2）构造函数的调用"></a>2）构造函数的调用</h3></li>
</ul>
<p>手工调用构造函数初始化对象</p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span><br><span class="line">#<span class="keyword">include</span> &lt;stdio.h&gt; </span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Test</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="built_in">int</span> m_value;</span><br><span class="line">public:</span><br><span class="line">	<span class="constructor">Test()</span></span><br><span class="line">	&#123;</span><br><span class="line">		printf(<span class="string">&quot;Test()\n&quot;</span>);</span><br><span class="line">		m_value = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="constructor">Test(<span class="params">int</span> <span class="params">v</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		printf(<span class="string">&quot;Test(int v), v = %d\n&quot;</span>,v);</span><br><span class="line">		m_value = v;</span><br><span class="line">	&#125;;</span><br><span class="line">	<span class="built_in">int</span> get<span class="constructor">Value()</span></span><br><span class="line">	&#123;</span><br><span class="line">		return m_value;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main<span class="literal">()</span></span><br><span class="line">&#123;	</span><br><span class="line">	Test ta<span class="literal">[<span class="number">3</span>]</span> = &#123;<span class="constructor">Test()</span>,<span class="constructor">Test(1)</span>,<span class="constructor">Test(2)</span>&#125;; <span class="comment">// 手动调用构造函数初始化对象数组的成员变量</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="built_in">int</span> i = <span class="number">0</span>; i&lt;<span class="number">3</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		printf(<span class="string">&quot;ta[%d].m_value = %d\n&quot;</span>,i,ta<span class="literal">[<span class="identifier">i</span>]</span>.get<span class="constructor">Value()</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Test t = <span class="constructor">Test(3)</span>;	<span class="comment">//手动调用构造函数初始化对象</span></span><br><span class="line"></span><br><span class="line">	printf(<span class="string">&quot;t.m_value = %d\n&quot;</span>,t.get<span class="constructor">Value()</span>);</span><br><span class="line"></span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"><span class="constructor">Test()</span></span><br><span class="line"><span class="constructor">Test(<span class="params">int</span> <span class="params">v</span>)</span>, v = <span class="number">1</span></span><br><span class="line"><span class="constructor">Test(<span class="params">int</span> <span class="params">v</span>)</span>, v = <span class="number">2</span></span><br><span class="line">ta<span class="literal">[<span class="number">0</span>]</span>.m_value = <span class="number">0</span></span><br><span class="line">ta<span class="literal">[<span class="number">1</span>]</span>.m_value = <span class="number">1</span></span><br><span class="line">ta<span class="literal">[<span class="number">2</span>]</span>.m_value = <span class="number">2</span></span><br><span class="line"><span class="constructor">Test(<span class="params">int</span> <span class="params">v</span>)</span>, v = <span class="number">3</span></span><br><span class="line">t.m_value = <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h3 id="3）小实例"><a href="#3）小实例" class="headerlink" title="3）小实例"></a>3）小实例</h3><p>开发一个数组类结局原生数组的安全性问题<br>-提供函数获取数组长度<br>-提供函数获取数组元素<br>-提供函数设置数组元素</p>
<ul>
<li><strong>头文件</strong><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _INTARRY_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _INTARRY_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntArry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> m_length;</span><br><span class="line">	<span class="keyword">int</span>* m_pointer;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	IntArry(<span class="keyword">int</span> len);</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span>&amp; value)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure></li>
<li><strong>函数功能实现</strong><figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#include &quot;StdAfx.h&quot;</span></span><br><span class="line"><span class="meta">#include &quot;intarry.h&quot;</span></span><br><span class="line"></span><br><span class="line">IntArry::IntArry(<span class="type">int</span> len)</span><br><span class="line">&#123;</span><br><span class="line">	m_pointer = <span class="built_in">new</span> <span class="type">int</span>[len];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[i] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	m_length = len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> IntArry::length()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> m_length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> IntArry::<span class="keyword">get</span>(<span class="type">int</span> <span class="keyword">index</span>, <span class="type">int</span>&amp; <span class="keyword">value</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">bool</span> ret = ( <span class="number">0</span>&lt;= <span class="keyword">index</span>) &amp;&amp; (<span class="keyword">index</span> &lt;= m_length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( ret )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">value</span> = m_pointer[<span class="keyword">index</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">bool</span> IntArry::<span class="keyword">set</span>(<span class="type">int</span> <span class="keyword">index</span>, <span class="type">int</span> <span class="keyword">value</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">bool</span> ret = ( <span class="number">0</span>&lt;= <span class="keyword">index</span>) &amp;&amp; (<span class="keyword">index</span> &lt;= m_length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( ret )</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[<span class="keyword">index</span>] = <span class="keyword">value</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> IntArry::free()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">delete</span>[]m_pointer;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>主函数测试</strong><figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line"></span><br><span class="line">	<span class="function">IntArry <span class="title">a</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;a.length(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a.<span class="built_in">set</span>(i,i+<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;a.length(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> value = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(a.<span class="built_in">get</span>(i,value))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;a[%d] = %d\n&quot;</span>,i,value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	a.<span class="built_in">free</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">a[<span class="number">1</span>] = <span class="number">2</span></span><br><span class="line">a[<span class="number">2</span>] = <span class="number">3</span></span><br><span class="line">a[<span class="number">3</span>] = <span class="number">4</span></span><br><span class="line">a[<span class="number">4</span>] = <span class="number">5</span></span><br></pre></td></tr></table></figure>
<h2 id="4、特殊的构造函数"><a href="#4、特殊的构造函数" class="headerlink" title="4、特殊的构造函数"></a>4、特殊的构造函数</h2></li>
</ul>
<h3 id="1）无惨构造函数"><a href="#1）无惨构造函数" class="headerlink" title="1）无惨构造函数"></a>1）无惨构造函数</h3><p>没有参数的构造函数，当类中<strong>没有定义任意构造函数</strong>时，编译器<strong>默认提供一个无参拷贝构造函数</strong>，并且其函数体为空</p>
<h3 id="2）拷贝构造函数"><a href="#2）拷贝构造函数" class="headerlink" title="2）拷贝构造函数"></a>2）拷贝构造函数</h3><p>参数为 const class_name&amp; 的构造函数，当类中<strong>没有定义拷贝构造函数</strong>时，<strong>编译器默认提供一个拷贝构造函数</strong>，简单的进行成员变量的值复制(浅拷贝)。</p>
<blockquote>
<p>拷贝构造函数的意义<br>兼容C语言的初始化方式，初始化行为能够符合预期的逻辑。</p>
</blockquote>
<h4 id="a-浅拷贝"><a href="#a-浅拷贝" class="headerlink" title="a. 浅拷贝"></a>a. 浅拷贝</h4><p>拷贝后对象的物理状态相同，编译器提供的拷贝构造函数只进行浅拷贝</p>
<ul>
<li><strong>编程实验</strong><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">int</span> j;</span><br><span class="line">	<span class="keyword">int</span> *p;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getI</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> i;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getJ</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> j;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span>* <span class="title">getP</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> p;&#125;</span><br><span class="line">	Test(<span class="keyword">int</span> v)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">1</span>;</span><br><span class="line">		j = <span class="number">2</span>;</span><br><span class="line">		p = <span class="keyword">new</span> <span class="keyword">int</span>;</span><br><span class="line">		*p = v;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">delete</span> p;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Test <span class="title">t1</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	Test t2 = t1;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t1.i = %d, t1.j = %d,t1.p = %p\n&quot;</span>,t1.getI(),t1.getJ(),t1.getP());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t2.i = %d, t2.j = %d,t2.p = %p\n&quot;</span>,t2.getI(),t2.getJ(),t2.getP());</span><br><span class="line"></span><br><span class="line">	t1.<span class="built_in">free</span>();</span><br><span class="line">	<span class="comment">//t2.free(); //多次释放造成内存泄漏 </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">t1.i = <span class="number">1</span>, t1.j = <span class="number">2</span>,t1.p = <span class="number">01323488</span></span><br><span class="line">t2.i = <span class="number">1</span>, t2.j = <span class="number">2</span>,t2.p = <span class="number">01323488</span></span><br></pre></td></tr></table></figure>
运行结果分析，函数中没有拷贝构造函数因此，默认提供了一个拷贝构造函数如下<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Test(<span class="keyword">const</span> Test&amp; t)</span><br><span class="line">&#123;</span><br><span class="line">	i = t.i;</span><br><span class="line">	j = t.j;</span><br><span class="line">	p = t.p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
因此得到的指针t1.p 与 t2.p指向同一个内存空间，对象 t2 并没有新生成一个堆空间的int大小的内存。所以分别运行两个对象的free释放函数会造成内存空间的重复释放，导致内存泄漏，编译报错。</li>
</ul>
<h4 id="b-深拷贝"><a href="#b-深拷贝" class="headerlink" title="b. 深拷贝"></a>b. 深拷贝</h4><p>拷贝后对象的逻辑状态相同</p>
<ul>
<li><strong>编程实验</strong><br>手动提供拷贝构造函数实现深拷贝<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">int</span> j;</span><br><span class="line">	<span class="keyword">int</span> *p;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getI</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> i;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getJ</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> j;&#125;</span><br><span class="line">	<span class="function"><span class="keyword">int</span>* <span class="title">getP</span><span class="params">()</span></span>&#123;<span class="keyword">return</span> p;&#125;</span><br><span class="line"></span><br><span class="line">	Test(<span class="keyword">int</span> v)</span><br><span class="line">	&#123;</span><br><span class="line">		i = <span class="number">1</span>;</span><br><span class="line">		j = <span class="number">2</span>;</span><br><span class="line">		p = <span class="keyword">new</span> <span class="keyword">int</span>;</span><br><span class="line">		*p = v;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Test(<span class="keyword">const</span> Test&amp; t) <span class="comment">//手动提供构造函数</span></span><br><span class="line">	&#123;</span><br><span class="line">		i = t.i;</span><br><span class="line">		j = t.j;</span><br><span class="line">		p = <span class="keyword">new</span> <span class="keyword">int</span>;</span><br><span class="line">		*p = *t.p;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">delete</span> p;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Test <span class="title">t1</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	Test t2 = t1;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t1.i = %d, t1.j = %d,t1.p = %p\n&quot;</span>,t1.getI(),t1.getJ(),t1.getP());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t2.i = %d, t2.j = %d,t2.p = %p\n&quot;</span>,t2.getI(),t2.getJ(),t2.getP());</span><br><span class="line"></span><br><span class="line">	t1.<span class="built_in">free</span>();</span><br><span class="line">	t2.<span class="built_in">free</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">t1.i = <span class="number">1</span>, t1.j = <span class="number">2</span>,t1.p = <span class="number">00</span>CF3488</span><br><span class="line">t2.i = <span class="number">1</span>, t2.j = <span class="number">2</span>,t2.p = <span class="number">00</span>CF34C8</span><br></pre></td></tr></table></figure>
第24行手动提供拷贝构造函数实现深拷贝，通过28,29行操作实现深拷贝</li>
</ul>
<h3 id="3）什么时候需要深拷贝"><a href="#3）什么时候需要深拷贝" class="headerlink" title="3）什么时候需要深拷贝"></a>3）什么时候需要深拷贝</h3><p>成员指向了动态内存空间<br>成员打开了外存中的文件<br>成员使用了系统中的网络端口</p>
<h3 id="4）数组类的改进"><a href="#4）数组类的改进" class="headerlink" title="4）数组类的改进"></a>4）数组类的改进</h3><p><strong>intarry.h文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _INTARRY_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _INTARRY_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntArry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> m_length;</span><br><span class="line">	<span class="keyword">int</span>* m_pointer;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	IntArry(<span class="keyword">int</span> len);</span><br><span class="line">	IntArry(<span class="keyword">const</span> IntArry&amp; obj); <span class="comment">//添加拷贝构造函数</span></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span>&amp; value)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p><strong>intarry.c文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;StdAfx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">IntArry::IntArry(<span class="keyword">int</span> len)</span><br><span class="line">&#123;</span><br><span class="line">	m_pointer = <span class="keyword">new</span> <span class="keyword">int</span>[len];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; len; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[i] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	m_length = len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">IntArry::IntArry(<span class="keyword">const</span> IntArry&amp; obj) <span class="comment">//手动实现深拷贝</span></span><br><span class="line">&#123;</span><br><span class="line">	m_pointer = <span class="keyword">new</span> <span class="keyword">int</span>[obj.m_length];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; obj.m_length; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[i] = obj.m_pointer[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	m_length = obj.m_length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IntArry::length</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> m_length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IntArry::get</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span>&amp; value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> ret = ( <span class="number">0</span>&lt;= index) &amp;&amp; (index &lt;= m_length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( ret )</span><br><span class="line">	&#123;</span><br><span class="line">		value = m_pointer[index];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IntArry::set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> ret = ( <span class="number">0</span>&lt;= index) &amp;&amp; (index &lt;= m_length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( ret )</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[index] = value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IntArry::free</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">delete</span>[]m_pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>测试函数</strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">IntArry <span class="title">a</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; a.length(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a.<span class="built_in">set</span>(i, i + <span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; a.length(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> value = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(a.<span class="built_in">get</span>(i, value))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;a[%d] = %d\n&quot;</span>,i,value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	IntArry b = a;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt; b.length(); i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">int</span> value = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(b.<span class="built_in">get</span>(i, value))</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;b[%d] = %d\n&quot;</span>,i,value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	a.<span class="built_in">free</span>();</span><br><span class="line">	b.<span class="built_in">free</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="初始化列表"><a href="#初始化列表" class="headerlink" title="初始化列表"></a>初始化列表</h1><p>用于初始化类对象中的成员变量</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="symbol">ClassName:</span>:ClassName():</span><br><span class="line">	m1(<span class="built_in">v1</span>), m2(<span class="built_in">v1</span>,<span class="built_in">v2</span>), m3(<span class="built_in">v3</span>)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="comment">// some other initialize opreration</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="1、初始化列表的初始顺序"><a href="#1、初始化列表的初始顺序" class="headerlink" title="1、初始化列表的初始顺序"></a>1、初始化列表的初始顺序</h2><p>-成员的初始化顺序与成员的申明顺序相同<br>-成员的初始化顺序与初始化列表中的位置无关<br>-初始化列表先于构造函数的函数体执行</p>
<p><strong>编程实验</strong><br>验证初始化列表的初始顺序</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Value</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> mi;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Value(<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;i = %d\n&quot;</span>,i);</span><br><span class="line">		mi = i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getMI</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mi;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	Value m2;  <span class="comment">//初始化列表先初始化这个变量</span></span><br><span class="line">	Value m3;</span><br><span class="line">	Value m1; <span class="comment">//初始化列表最后初始化这个变量</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test() : m1(<span class="number">1</span>),m2(<span class="number">2</span>),m3(<span class="number">3</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">getCI</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ci;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Test t;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;	</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">i = <span class="number">2</span></span><br><span class="line">i = <span class="number">3</span></span><br><span class="line">i = <span class="number">1</span></span><br><span class="line">Test</span><br></pre></td></tr></table></figure>
<h2 id="2、类中的const成员"><a href="#2、类中的const成员" class="headerlink" title="2、类中的const成员"></a>2、类中的const成员</h2><p>类中的const成员会被分配内存空间<br>类中的const成员的本质是只读变量<br>类中的const成员只能在初始化列表中指定初始化值<br>编译器无法直接得到const成员的初始值，因此无法进入符号表成为真正意义上的常量</p>
<p><strong>编程实验</strong><br>类中的const成员变量本质为只读变量</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt; </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">int</span> ci;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test() : ci(<span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">const</span> <span class="keyword">int</span> <span class="title">getCI</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> ci;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">setCI</span><span class="params">(<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> *p = <span class="keyword">const_cast</span>&lt;<span class="keyword">int</span> *&gt;(&amp;ci); <span class="comment">//通过指针修改ci的值</span></span><br><span class="line"></span><br><span class="line">		*p = v;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Test t;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t.ci = %d\n&quot;</span>,t.getCI());</span><br><span class="line"></span><br><span class="line">	t.setCI(<span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t.ci = %d\n&quot;</span>,t.getCI());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">t.ci = <span class="number">0</span></span><br><span class="line">t.ci = <span class="number">2</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>初始化与赋值不同<br>初始化：对<strong>正在创建的对象</strong>进行初始值设置<br>赋值：对<strong>已经存在的对象</strong>进行值的设置</p>
</blockquote>
<h1 id="对象的构造顺序"><a href="#对象的构造顺序" class="headerlink" title="对象的构造顺序"></a>对象的构造顺序</h1><p><strong>1. 局部对象</strong><br>当程序执行流到达对象定义的语句时进行构造<br><strong>2. 堆对象的构造顺序</strong><br>堆对象的构造与new关键字以及程序执行流有关<br><strong>3. 全局对象的构造顺序</strong><br>对象的构造顺序是不确定的，不同的编译器使用不同规则的构造顺序</p>
<blockquote>
<p>尽量避免使用全局变量与全局对象，以及全局对象之间的依赖</p>
</blockquote>
<h1 id="对象的销毁"><a href="#对象的销毁" class="headerlink" title="对象的销毁"></a>对象的销毁</h1><p>C++类中定义的一个特殊的清理函数，析构函数的功能与构造函数相反</p>
<figure class="highlight haml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">~ClassName()</span><br></pre></td></tr></table></figure>
<p>-析构函数没有参数也没有返回值类型声明<br>-析构函数在对象销毁值自动被调用</p>
<p><strong>编程实验</strong><br>验证析构函数的自动调用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test()\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	~Test()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;~Test()\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	&#123; <span class="comment">//定义对象的作用域</span></span><br><span class="line">		Test t; <span class="comment">// 对象被销毁后自动调用析构函数</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">Test()</span><br><span class="line">~Test()</span><br></pre></td></tr></table></figure>
<blockquote>
<p>析构函数的定义准则<br>当类中定义了构造函数，并且构造函数使用了系统资源（内存申请，文件打开，等）则需要自定义析构函数<br>析构函数时对象释放系统资源的保障</p>
</blockquote>
<h1 id="临时对象"><a href="#临时对象" class="headerlink" title="临时对象"></a>临时对象</h1><h2 id="1、临时对象的产生"><a href="#1、临时对象的产生" class="headerlink" title="1、临时对象的产生"></a>1、临时对象的产生</h2><p>直接调用构造函数将产生一个<strong>临时对象</strong><br>临时对象的<strong>生命周期只有一条语句的时间</strong><br>临时对象的作用于<strong>只在一条语句中</strong><br>临时对象时c++中<strong>值得谨惕</strong>的灰色地带</p>
<p><strong>编程实验</strong><br>验证临时对象</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> mi;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test(<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		mi = i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		Test(<span class="number">1</span>);<span class="comment">//直接调用构造函数产生零时对象</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mi = %d\n&quot;</span>,mi);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	Test t; </span><br><span class="line">	t.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">mi = <span class="number">-858993460</span></span><br></pre></td></tr></table></figure>
<p>运行结果分析：本来第16行调用构造函数的目的是初始化mi，使得mi的值为1，但运行结果为一个随机值，产生的原因就是16行直接调用有参数的构造函数得到了一个临时对象。16行的临时对象的生命周期只有16行这条语句，过了这条语句之后这个临时对象就被析构。这个临时对象同时没有名字，所以临时对象的作用域也只有这一条语句。因此16行这条语句没有半毛钱作用。16行代码等价于一条空语句。</p>
<p>解决方案，提供一个私有的初始化函数。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> mi;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> i)</span> <span class="comment">//提供私有的init函数</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		mi = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test(<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		mi = i;</span><br><span class="line">	&#125;</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		init(<span class="number">1</span>); <span class="comment">//调用私有的init初始化函数</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mi = %d\n&quot;</span>,mi);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	Test t; </span><br><span class="line">	t.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">mi = <span class="number">1</span></span><br></pre></td></tr></table></figure>

<p><strong>深入验证临时对象</strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> mi;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		mi = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test(<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test(int i)\n&quot;</span>);</span><br><span class="line">		mi = i;</span><br><span class="line">	&#125;</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test()\n&quot;</span>);</span><br><span class="line">		init(<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	~Test()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;~Test()\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mi = %d\n&quot;</span>,mi);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Main begin \n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	Test().<span class="built_in">print</span>();  <span class="comment">//直接调用构造函数产生临时对象 </span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	Test(<span class="number">3</span>).<span class="built_in">print</span>(); <span class="comment">//直接调用构造函数产生临时对象 </span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Main end... \n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">运行结果：</span><br><span class="line">Main <span class="built_in">begin</span></span><br><span class="line">Test()</span><br><span class="line">mi = <span class="number">1</span></span><br><span class="line">~Test()</span><br><span class="line"></span><br><span class="line">Test(<span class="keyword">int</span> i)</span><br><span class="line">mi = <span class="number">3</span></span><br><span class="line">~Test()</span><br><span class="line">Main <span class="built_in">end</span>...</span><br></pre></td></tr></table></figure>
<p>运行结果分析：37行与39行直接调用构造函数产生临时对象，因此Test()/Test(3)为临时生成的对象，可以直接调用他们的成员函数print。同时也验证了临时对象的生命周期为一条语句的时间。</p>
<h2 id="2、临时对象的优化"><a href="#2、临时对象的优化" class="headerlink" title="2、临时对象的优化"></a>2、临时对象的优化</h2><p>现代C++编译器在不影响最终执行结果的前提下，会尽力减少临时对象的产生</p>
<p>代码分析</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> mi;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		mi = <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test(<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test(int i)\n&quot;</span>);</span><br><span class="line">		mi = i;</span><br><span class="line">	&#125;</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test()\n&quot;</span>);</span><br><span class="line">		init(<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	~Test()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;~Test()\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;mi = %d\n&quot;</span>,mi);</span><br><span class="line">	&#125;</span><br><span class="line">	Test(<span class="keyword">const</span> Test&amp; obj)</span><br><span class="line">	&#123;</span><br><span class="line">		mi = obj.mi;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;Test(const Test&amp; obj): %d\n&quot;</span>,mi);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">Test <span class="title">func</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> Test(<span class="number">3</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Main begin \n&quot;</span>);</span><br><span class="line"></span><br><span class="line">	Test t = Test(<span class="number">1</span>);	<span class="comment">// ==&gt; Test t = 1;</span></span><br><span class="line"></span><br><span class="line">	Test t3 = func();	<span class="comment">// ==&gt; Test t3 = Test(3) ==&gt; Test t3 = 3;</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Main end... \n&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>第47,49行运行个过程应该如下</p>
<ol>
<li>生成临时对象</li>
<li>用临时对象初始化t对象</li>
<li>调用拷贝构造函数</li>
</ol>
<p>但实际的运行结果发现并没有拷贝构造函数的调用，产生这个结果的原因就是编译器为了杜绝临时对象的产生因此对代47,49行码进行了优化，优化后的代码如下</p>
</blockquote>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Test </span>t = 1;</span><br><span class="line"><span class="keyword">Test </span>t3 = 3;</span><br></pre></td></tr></table></figure>
<p>所以代码没有调用拷贝构造函数</p>
<p><strong>注意：</strong><br>临时对象时性能的瓶颈，也是bug的来源之一<br>实际工程开发中需要人为的避开临时对象</p>
<h1 id="经典问题分析"><a href="#经典问题分析" class="headerlink" title="经典问题分析"></a>经典问题分析</h1><h2 id="1、构造函数与析构函数的调用顺序"><a href="#1、构造函数与析构函数的调用顺序" class="headerlink" title="1、构造函数与析构函数的调用顺序"></a>1、构造函数与析构函数的调用顺序</h2><h3 id="1）单个对象创建时"><a href="#1）单个对象创建时" class="headerlink" title="1）单个对象创建时"></a>1）单个对象创建时</h3><ol>
<li>调用父类的构造过程</li>
<li>调用成员变量的构造函数（调用顺序与声明顺序相同）</li>
<li>调用自身类的构造函数</li>
</ol>
<p>析构函数与对应构造函数的调用顺序相反</p>
<p><strong>编程实验</strong></p>
<figure class="highlight reasonml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span><br><span class="line">#<span class="keyword">include</span> &lt;stdio.h&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Member</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	const <span class="built_in">char</span>* ms;</span><br><span class="line">public:</span><br><span class="line">	<span class="constructor">Member(<span class="params">const</span> <span class="params">char</span><span class="operator">*</span> <span class="params">s</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		printf(<span class="string">&quot;Member(const char* s): %s\n&quot;</span>,s);</span><br><span class="line">		ms = s;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="constructor">Member()</span></span><br><span class="line">	&#123;</span><br><span class="line">		printf(<span class="string">&quot;~Member(): %s\n&quot;</span>,ms);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> Test</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	Member mA;</span><br><span class="line">	Member mB;</span><br><span class="line">public:</span><br><span class="line">	<span class="constructor">Test()</span>: m<span class="constructor">B(<span class="string">&quot;mB&quot;</span>)</span>, m<span class="constructor">A(<span class="string">&quot;mA&quot;</span>)</span></span><br><span class="line">	&#123;</span><br><span class="line">		printf(<span class="string">&quot;Test()\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	~<span class="constructor">Test()</span></span><br><span class="line">	&#123;</span><br><span class="line">		printf(<span class="string">&quot;~Test()\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main<span class="literal">()</span></span><br><span class="line">&#123;</span><br><span class="line">	&#123;</span><br><span class="line">	Test t;</span><br><span class="line">	&#125;</span><br><span class="line">    return <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"><span class="constructor">Member(<span class="params">const</span> <span class="params">char</span><span class="operator">*</span> <span class="params">s</span>)</span>: mA</span><br><span class="line"><span class="constructor">Member(<span class="params">const</span> <span class="params">char</span><span class="operator">*</span> <span class="params">s</span>)</span>: mB</span><br><span class="line"><span class="constructor">Test()</span></span><br><span class="line">~<span class="constructor">Test()</span></span><br><span class="line">~<span class="constructor">Member()</span>: mB</span><br><span class="line">~<span class="constructor">Member()</span>: mA</span><br></pre></td></tr></table></figure>
<h3 id="2）栈对象和全局对象"><a href="#2）栈对象和全局对象" class="headerlink" title="2）栈对象和全局对象"></a>2）栈对象和全局对象</h3><p>对于栈对象和全局对象，类似于入栈于出栈的顺序，最后构造的对象被最先析构</p>
<h3 id="3）堆对象"><a href="#3）堆对象" class="headerlink" title="3）堆对象"></a>3）堆对象</h3><p>堆对象的构造发生在new关键字调用的时候，析构则是发生在使用delete的时候，与delete的使用顺序有关。</p>
<h2 id="2、const对象"><a href="#2、const对象" class="headerlink" title="2、const对象"></a>2、const对象</h2><p>const能够修饰对象<br>const修饰的对象为只读对象<br>只读对象的成员变量不允许改变<br>只读对象是编译阶段的概念，运行期无效</p>
<h3 id="1）C-中的const成员函数"><a href="#1）C-中的const成员函数" class="headerlink" title="1）C++中的const成员函数"></a>1）C++中的const成员函数</h3><p>const对象<strong>只能调用const的成员函数</strong><br>const成员函数中<strong>只能调用const成员函数</strong><br>const成员函数<strong>不能直接改写成员变量的值</strong></p>
<p>const成员函数的定义</p>
<blockquote>
<p>Type ClassName::function(type p) const</p>
</blockquote>
<p>类中的声明和实际的成员函数中都必须带const关键字</p>
<h2 id="3、对象的构成"><a href="#3、对象的构成" class="headerlink" title="3、对象的构成"></a>3、对象的构成</h2><p>问题：成员函数和成员变量都是隶属于具体的对象吗</p>
<p><strong>从面向对象的角度</strong><br>-对象由属性（成员变量），和方法（成员函数）构成<br><strong>从程序运行角度</strong><br>-对象有由数据和函数组成<br>*数据可以位于栈，堆和全局数据区<br>*函数只能位于代码段</p>
<blockquote>
<p>结论:<br>每一个对象拥有自己独立的属性（成员变量）<br>所有的对象共享创建他的的类的方法（成员函数）<br>方法能够直接访问对象的属性<br>方法中的隐藏参数 this用于指代当前对象</p>
</blockquote>
<ul>
<li><strong>成员函数只有一套，他能直接访问任何所属类对象的成员变量</strong></li>
</ul>
<p><strong>编程实验</strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> mi;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test(<span class="keyword">int</span> i);</span><br><span class="line">	Test(<span class="keyword">const</span> Test&amp; obj);</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getMi</span><span class="params">()</span><span class="keyword">const</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Test::Test(<span class="keyword">int</span> i)</span><br><span class="line">&#123;</span><br><span class="line">	mi = i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Test::Test(<span class="keyword">const</span> Test&amp; obj)</span><br><span class="line">&#123;</span><br><span class="line">	mi = obj.mi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Test::getMi</span><span class="params">()</span><span class="keyword">const</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> mi;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Test::print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;this = %p\n\n&quot;</span>,<span class="keyword">this</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Test <span class="title">t1</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line">	<span class="function">Test <span class="title">t2</span><span class="params">(<span class="number">2</span>)</span></span>;</span><br><span class="line">	<span class="function">Test <span class="title">t3</span><span class="params">(<span class="number">3</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t1.getMi() = %d\n&quot;</span>,t1.getMi());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;t1 = %p\n&quot;</span>,&amp;t1);</span><br><span class="line">	t1.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t2.getMi() = %d\n&quot;</span>,t2.getMi());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;t2 = %p\n&quot;</span>,&amp;t2);</span><br><span class="line">	t2.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;t3.getMi() = %d\n&quot;</span>,t3.getMi());</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;&amp;t3 = %p\n&quot;</span>,&amp;t3);</span><br><span class="line">	t3.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="类的静态成员变量与成员函数"><a href="#类的静态成员变量与成员函数" class="headerlink" title="类的静态成员变量与成员函数"></a>类的静态成员变量与成员函数</h1><h2 id="1、类的静态成员变量"><a href="#1、类的静态成员变量" class="headerlink" title="1、类的静态成员变量"></a>1、类的静态成员变量</h2><p>静态成员变量属于整个类所有<br>所有对象共享类的静态成员变量<br>静态成员变量的生命周期不依赖与任何对象<br>可以通过对象名访问公有(public)静态成员变量<br>可以通过类名直接访问公有(public)静态成员变量</p>
<ul>
<li><strong>静态成员变量的特性</strong></li>
</ul>
<p>-在定义时直接通过static关键字修饰<br>-静态成员变量需要在类外单独分配空间<br>-静态成员变量在程序内部位于全局数据区</p>
<ul>
<li><strong>定义静态成员变量的语法规则</strong><figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Type</span> <span class="type">ClassName::VarName </span>= value;</span><br></pre></td></tr></table></figure>
<h2 id="2、类的静态成员函数"><a href="#2、类的静态成员函数" class="headerlink" title="2、类的静态成员函数"></a>2、类的静态成员函数</h2></li>
</ul>
<p>静态成员函数是类中特殊的成员函数<br>静态成员函数属于整个类所有<br>可以通过类名直接访问共有静态成员函数<br>可以通过对象名访问公有静态成员函数</p>
<h3 id="1）静态成员函数的定义"><a href="#1）静态成员函数的定义" class="headerlink" title="1）静态成员函数的定义"></a>1）静态成员函数的定义</h3><p>直接通过static关键字修饰生源函数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">func1</span><span class="params">()</span></span>&#123;&#125;;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">func2</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Test::func2</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>编程体验</strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Demo</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getI</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">staticFunc</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">staticSetI</span><span class="params">(Demo&amp; d,<span class="keyword">int</span> v)</span></span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">Demo::getI</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> i;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Demo::staticFunc</span><span class="params">(<span class="keyword">const</span> <span class="keyword">char</span>* s)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;staticFunc: %s\n&quot;</span>,s);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Demo::staticSetI</span><span class="params">(Demo&amp; d,<span class="keyword">int</span> v)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	d.i = v;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"></span><br><span class="line">	Demo::staticFunc(<span class="string">&quot;main begin...&quot;</span>); <span class="comment">//直接通过类名调用静态成员函数</span></span><br><span class="line"></span><br><span class="line">	Demo d;</span><br><span class="line">	d.staticSetI(d,<span class="number">1</span>); <span class="comment">//通过对象名访问静态成员函数</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;d.i = %d\n&quot;</span>,d.getI());</span><br><span class="line"></span><br><span class="line">	Demo::staticFunc(<span class="string">&quot;main end...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line">运行结果：</span><br><span class="line">staticFunc: main <span class="built_in">begin</span>...</span><br><span class="line">d.i = <span class="number">1</span></span><br><span class="line">staticFunc: main <span class="built_in">end</span>...</span><br></pre></td></tr></table></figure>
<h3 id="2）普通与静态成员函数对比"><a href="#2）普通与静态成员函数对比" class="headerlink" title="2）普通与静态成员函数对比"></a>2）普通与静态成员函数对比</h3><table>
<thead>
<tr>
<th>静态成员函数vs普通成员函数</th>
<th>静态成员函数</th>
<th>普通成员函数</th>
</tr>
</thead>
<tbody><tr>
<td>所有对象共享</td>
<td><div align=center>Yes</td>
<td><div align=center>Yes</td>
</tr>
<tr>
<td>隐含this指针(函数)</td>
<td><div align=center>No</td>
<td><div align=center>Yes</td>
</tr>
<tr>
<td>访问普通成员变量(函数)</td>
<td><div align=center>No</td>
<td><div align=center>Yes</td>
</tr>
<tr>
<td>通过类名直接调用</td>
<td><div align=center>Yes</td>
<td><div align=center>No</td>
</tr>
<tr>
<td>通过对象名直接调用</td>
<td><div align=center>Yes</td>
<td><div align=center>Yes</td>
</tr>
</tbody></table>
<h2 id="3、小实例"><a href="#3、小实例" class="headerlink" title="3、小实例"></a>3、小实例</h2><p>需求：统计在程序运行期间某个类的对象数目，保证程序的安全性（不能使用全局变量），随时可以获取当前对象的数目</p>
<p><strong>编程实现</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">static</span> <span class="keyword">int</span> mCount;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		mCount++;</span><br><span class="line">	&#125;</span><br><span class="line">	~Test()</span><br><span class="line">	&#123;</span><br><span class="line">		mCount--;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getCount</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mCount;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Test::mCount = <span class="number">0</span>; <span class="comment">//定义静态成员变量，并初始化为0</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	Test t0;</span><br><span class="line">	Test t1;</span><br><span class="line">	Test t2;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Test::mCount = %d\n&quot;</span>,Test::getCount()); <span class="comment">//通过类名访问静态函数得到mCount</span></span><br><span class="line">	</span><br><span class="line">	Test* pt = <span class="keyword">new</span> Test;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Test::mCount = %d\n&quot;</span>,Test::getCount());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">delete</span> pt;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Test::mCount = %d\n&quot;</span>,Test::getCount());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">Test::mCount = <span class="number">3</span></span><br><span class="line">Test::mCount = <span class="number">4</span></span><br><span class="line">Test::mCount = <span class="number">3</span></span><br></pre></td></tr></table></figure>
<h1 id="二阶构造模式"><a href="#二阶构造模式" class="headerlink" title="二阶构造模式"></a>二阶构造模式</h1><h2 id="1、半成品对象"><a href="#1、半成品对象" class="headerlink" title="1、半成品对象"></a>1、半成品对象</h2><p>-初始化操作不能按照预期完成而得到的对象<br>-半成品对象是合法的C++对象，也是Bug重要来源</p>
<blockquote>
<p>构造函数能决定的知识对象的初始状态，而不是对象的诞生</p>
</blockquote>
<h2 id="2、划分构造过程"><a href="#2、划分构造过程" class="headerlink" title="2、划分构造过程"></a>2、划分构造过程</h2><ul>
<li><strong>资源无关的初始化操作</strong><br>不可能出现异常情况的操作</li>
<li><strong>需要使用系统资源的操作</strong><br>可能出现异常情况，如：内存申请，访问文件</li>
</ul>
<p>二阶构造能够确保创建的对象都是完整初始化的</p>
<h2 id="4、二阶构造示例"><a href="#4、二阶构造示例" class="headerlink" title="4、二阶构造示例"></a>4、二阶构造示例</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TwoPhaseCons</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	TwoPhaseCons()&#123;  <span class="comment">//第一阶段构造函数</span></span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">construct</span><span class="params">()</span></span>&#123; <span class="comment">//第二阶段构造函数</span></span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> TwoPhaseCons* <span class="title">NewInstance</span><span class="params">()</span></span>; <span class="comment">//对象创建函数</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function">TwoPhaseCons* <span class="title">TwoPhaseCons::NewInstance</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	TwoPhaseCons* ret = <span class="keyword">new</span> TwoPhaseCons;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 若二阶构造失败，返回NULL</span></span><br><span class="line">	<span class="keyword">if</span>(!(ret &amp;&amp; ret-&gt;construct()))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">delete</span> ret;</span><br><span class="line">		ret = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	TwoPhaseCons* p = TwoPhaseCons::NewInstance();</span><br><span class="line">	TwoPhaseCons* p1 = TwoPhaseCons::NewInstance();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;p = %p\n&quot;</span>,p);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;p1 = %p\n&quot;</span>,p1);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="优化数组类的实现"><a href="#优化数组类的实现" class="headerlink" title="优化数组类的实现"></a>优化数组类的实现</h2><p><strong>intarry.h文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _INTARRY_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _INTARRY_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntArry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> m_length;</span><br><span class="line">	<span class="keyword">int</span>* m_pointer;</span><br><span class="line">	IntArry(<span class="keyword">int</span> len);</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">construct</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> IntArry* <span class="title">NewIntArry</span><span class="params">(<span class="keyword">int</span> len)</span></span>; <span class="comment">//</span></span><br><span class="line">	IntArry(<span class="keyword">const</span> IntArry&amp; obj);</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span>&amp; value)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">()</span></span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>intarry.c文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;StdAfx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">IntArry::IntArry(<span class="keyword">int</span> len) <span class="comment">//一阶构造函数</span></span><br><span class="line">&#123;</span><br><span class="line">	m_length = len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IntArry::construct</span><span class="params">()</span> <span class="comment">//二阶构造函数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> ret = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">	m_pointer = <span class="keyword">new</span> <span class="keyword">int</span>[m_length];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( m_pointer )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_length; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			m_pointer[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		ret = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">IntArry::IntArry(<span class="keyword">const</span> IntArry&amp; obj)</span><br><span class="line">&#123;</span><br><span class="line">	m_pointer = <span class="keyword">new</span> <span class="keyword">int</span>[obj.m_length];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; obj.m_length; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[i] = obj.m_pointer[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	m_length = obj.m_length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">IntArry* <span class="title">IntArry::NewIntArry</span><span class="params">(<span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IntArry* ret = <span class="keyword">new</span> IntArry(len);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!(ret &amp;&amp; ret-&gt;construct()))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">delete</span>[] ret;</span><br><span class="line">		ret = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IntArry::length</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> m_length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IntArry::get</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span>&amp; value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> ret = ( <span class="number">0</span>&lt;= index) &amp;&amp; (index &lt;= m_length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( ret )</span><br><span class="line">	&#123;</span><br><span class="line">		value = m_pointer[index];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IntArry::set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> ret = ( <span class="number">0</span>&lt;= index) &amp;&amp; (index &lt;= m_length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( ret )</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[index] = value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">IntArry::free</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">delete</span>[]m_pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><strong>测试c文件</strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IntArry* a = IntArry::NewIntArry(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(a)</span><br><span class="line">	&#123;</span><br><span class="line">		a-&gt;<span class="built_in">set</span>(<span class="number">0</span>,<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i&lt;a-&gt;length(); i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> value = <span class="number">0</span>;</span><br><span class="line">			a-&gt;<span class="built_in">get</span>(i,value);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;a[%d] = %d\n&quot;</span>,i,value);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">delete</span> a;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">a[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">a[<span class="number">1</span>] = <span class="number">0</span></span><br><span class="line">a[<span class="number">2</span>] = <span class="number">0</span></span><br><span class="line">a[<span class="number">3</span>] = <span class="number">0</span></span><br><span class="line">a[<span class="number">4</span>] = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h1 id="被遗弃的友元"><a href="#被遗弃的友元" class="headerlink" title="被遗弃的友元"></a>被遗弃的友元</h1><p>友元是C++中的一种关系<br>友元关系发生在函数与类之间或者类与类之间<br>友元关系是单项的，不能传递</p>
<ul>
<li><p><strong>友元的用法</strong><br>在类中以friend关键字声明友元<br>类的友元可以是其他类或者具体函数<br>友元不是类的一部分<br>友元不收类中访问级别的限制<br>友元可以直接访问具体类的所有成员</p>
</li>
<li><p><strong>友元的语法</strong><br>在类中用friend关键字对函数或类进行声明</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Piont</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">double</span> x;</span><br><span class="line">	<span class="keyword">double</span> y;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">friend</span> <span class="keyword">void</span> <span class="title">func</span><span class="params">(Point&amp; p)</span></span>; <span class="comment">//声明了友元关系</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">func</span><span class="params">(Point&amp; p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	p.x = <span class="number">1</span>; <span class="comment">//可以直接访问类的私有成员变量</span></span><br><span class="line">	p.y = <span class="number">2</span>; <span class="comment">//可以直接访问类的私有成员变量</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p><strong>友元的尴尬</strong><br>友元是为了兼顾C语言的高效而诞生的<br>友元直接破坏了面向对象的封装特性<br>友元在实际产品中的高效是得不偿失的<br>友元在现代软件工程中已经逐渐被遗弃（对比c语言的goto语句）</p>
</li>
</ul>
<blockquote>
<p>注意事项：<br>友元不具备传递性<br>类的友元可以是其他类的成员函数<br>类的友元可以是某个完整的类：所有的成员函数都是友元</p>
</blockquote>
<p>插图</p>
<p><strong>编程实验</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassC</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span>* n;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	ClassC(<span class="keyword">const</span> <span class="keyword">char</span>* n)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassB</span>;</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassB</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span>* n;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	ClassB(<span class="keyword">const</span> <span class="keyword">char</span>* n)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">getClassCName</span><span class="params">(ClassC&amp; c)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;c.n = %s\n&quot;</span>,c.n);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">friend</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassA</span>;</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ClassA</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">const</span> <span class="keyword">char</span>* n;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	ClassA(<span class="keyword">const</span> <span class="keyword">char</span>* n)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;n = n;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">getClassBName</span><span class="params">(ClassB&amp; b)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;b.n = %s\n&quot;</span>,b.n);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*    //友元没有传递性，无法直接访问 c 的成员函数</span></span><br><span class="line"><span class="comment">	void getClassCName(ClassC&amp; c)</span></span><br><span class="line"><span class="comment">	&#123;</span></span><br><span class="line"><span class="comment">		//友元没有传递性，无法直接访问 c 的成员变量</span></span><br><span class="line"><span class="comment">		printf(c.n = %s\n&quot;,c.n);</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">ClassC <span class="title">c</span><span class="params">(<span class="string">&quot;C&quot;</span>)</span></span>;</span><br><span class="line">	<span class="function">ClassB <span class="title">b</span><span class="params">(<span class="string">&quot;B&quot;</span>)</span></span>;</span><br><span class="line">	<span class="function">ClassA <span class="title">a</span><span class="params">(<span class="string">&quot;A&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	b.getClassCName(c);</span><br><span class="line">	a.getClassBName(b);</span><br><span class="line">	<span class="comment">//a.getClassCName(c); </span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="类中的重载"><a href="#类中的重载" class="headerlink" title="类中的重载"></a>类中的重载</h1><p>类中成员函数可以进行重载<br>-构造函数的重载<br>-普通成员函数的重载<br>-静态成员函数的重载</p>
<p>重载函数的本质为多个不同的函数<br>函数名和参数列表是唯一表示<br>函数重载必须发生在同一个作用域中</p>
<p>重载的意义<br>-通过函数名对函数功能进行提示<br>-通过参数列表对函数用法进行提示<br>-扩展系统中已经存在的函数功能</p>
<h1 id="操作符重载"><a href="#操作符重载" class="headerlink" title="操作符重载"></a>操作符重载</h1><p>通过operator关键字可以定义特殊的函数<br>operator的本质是通过函数重载操作符</p>
<p>语法</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Type</span> <span class="type">operatorSign(const </span><span class="keyword">Type</span> <span class="type">p1, </span>const <span class="keyword">Type</span> <span class="type">p2)</span></span><br><span class="line"><span class="type">&#123;</span></span><br><span class="line"><span class="type">	</span><span class="keyword">Type</span> <span class="type">ret;</span></span><br><span class="line"><span class="type"></span></span><br><span class="line"><span class="type">	</span><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">sign: 为系统中预定义的操作符，如：+，-，*，/,等</span><br></pre></td></tr></table></figure>
<p>编程实验</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> a;</span><br><span class="line">	<span class="keyword">int</span> b;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Complex(<span class="keyword">const</span> <span class="keyword">int</span> a, <span class="keyword">const</span> <span class="keyword">int</span> b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;a = a;</span><br><span class="line">		<span class="keyword">this</span>-&gt;b = b;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getA</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getB</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> b;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">friend</span> Complex <span class="keyword">operator</span>+(<span class="keyword">const</span> Complex&amp; p1, <span class="keyword">const</span> Complex&amp; p2);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Complex <span class="keyword">operator</span>+(<span class="keyword">const</span> Complex&amp; p1, <span class="keyword">const</span> Complex&amp; p2)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="function">Complex <span class="title">ret</span><span class="params">(<span class="number">0</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	ret.a = p1.a + p2.a;</span><br><span class="line">	ret.b = p1.b + p2.b;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Complex <span class="title">a</span><span class="params">(<span class="number">1</span>,<span class="number">2</span>)</span></span>;</span><br><span class="line">    <span class="function">Complex <span class="title">b</span><span class="params">(<span class="number">1</span>,<span class="number">2</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	Complex c = a + b; <span class="comment">// operator+(a,b)</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;c.a = %d, c.b = %d\n&quot;</span>,c.getA(),c.getB());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">c.a = <span class="number">2</span>, c.b = <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>将操作符重载函数定义为类的成员函数<br>-比全局操作符重载函数少一个参数（左操作数）<br>-不需要依赖友元就可以完成操作符重载<br>-编译器有限在成员函数中寻找操作符重载函数</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="keyword">Type</span></span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">	<span class="keyword">Type</span> operator <span class="built_in">Sign</span>(<span class="keyword">const</span> <span class="keyword">Type</span>&amp; p)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">Type</span> <span class="keyword">ret</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> <span class="keyword">ret</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>编程实验</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> a;</span><br><span class="line">	<span class="keyword">int</span> b;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Complex(<span class="keyword">const</span> <span class="keyword">int</span> a, <span class="keyword">const</span> <span class="keyword">int</span> b)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">this</span>-&gt;a = a;</span><br><span class="line">		<span class="keyword">this</span>-&gt;b = b;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getA</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> a;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getB</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> b;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Complex <span class="keyword">operator</span>+(<span class="keyword">const</span> Complex&amp; p);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">Complex Complex::<span class="keyword">operator</span>+(<span class="keyword">const</span> Complex&amp; p)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="function">Complex <span class="title">ret</span><span class="params">(<span class="number">0</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	ret.a = <span class="keyword">this</span>-&gt;a + p.a;</span><br><span class="line">	ret.b = <span class="keyword">this</span>-&gt;b + p.b;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="function">Complex <span class="title">a</span><span class="params">(<span class="number">1</span>,<span class="number">2</span>)</span></span>;</span><br><span class="line">    <span class="function">Complex <span class="title">b</span><span class="params">(<span class="number">1</span>,<span class="number">2</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	Complex c = a+b; <span class="comment">// a.operator+(b)</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;c.a = %d, c.b = %d\n&quot;</span>,c.getA(),c.getB());</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">c.a = <span class="number">2</span>, c.b = <span class="number">4</span></span><br></pre></td></tr></table></figure>
<h2 id="实现一个复数类"><a href="#实现一个复数类" class="headerlink" title="实现一个复数类"></a>实现一个复数类</h2><p>复数类应该有的操作<br>-运算：+,-,*,/<br>-比较：==，！=<br>-赋值：=<br>-求模：modulus</p>
<p><strong>编程实现</strong><br>利用操作符重载<br>统一复数与实数的运算方式<br>统一复数与实数的比较方式</p>
<p><strong>complex.h文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _COMPLEX_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _COMPLEX_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Complex</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">double</span> a;</span><br><span class="line">	<span class="keyword">double</span> b;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Complex(<span class="keyword">double</span> a = <span class="number">0</span>, <span class="keyword">double</span> b = <span class="number">0</span>);</span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">getA</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">getB</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">double</span> <span class="title">getModulus</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">	Complex <span class="keyword">operator</span> + (Complex&amp; c);</span><br><span class="line">	Complex <span class="keyword">operator</span> - (Complex&amp; c);</span><br><span class="line">	Complex <span class="keyword">operator</span> * (Complex&amp; c);</span><br><span class="line">	Complex <span class="keyword">operator</span> / (Complex&amp; c);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> == (Complex&amp; c);</span><br><span class="line">	<span class="keyword">bool</span> <span class="keyword">operator</span> != (Complex&amp; c);</span><br><span class="line"></span><br><span class="line">	Complex&amp; <span class="keyword">operator</span> = (<span class="keyword">const</span> Complex&amp; c);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p><strong>complex.c文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;StdAfx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;complex.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"></span><br><span class="line">Complex::Complex(<span class="keyword">double</span> a, <span class="keyword">double</span> b)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">this</span>-&gt;a = a;</span><br><span class="line">	<span class="keyword">this</span>-&gt;b = b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Complex::getA</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Complex::getB</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> b;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">double</span> <span class="title">Complex::getModulus</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="built_in">sqrt</span>(a * a + b * b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Complex Complex::<span class="keyword">operator</span> + (Complex&amp; c)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">double</span> na = a + c.a;</span><br><span class="line">	<span class="keyword">double</span> nb = b + c.b;</span><br><span class="line">	<span class="function">Complex <span class="title">ret</span><span class="params">(na,nb)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Complex Complex::<span class="keyword">operator</span> - (Complex&amp; c)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">double</span> na = a - c.a;</span><br><span class="line">	<span class="keyword">double</span> nb = b - c.b;</span><br><span class="line">	<span class="function">Complex <span class="title">ret</span><span class="params">(na,nb)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Complex Complex::<span class="keyword">operator</span> * (Complex&amp; c)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">double</span> na = a * c.a - b * c.b;</span><br><span class="line">	<span class="keyword">double</span> nb = a * c.b + b * c.a;</span><br><span class="line">	<span class="function">Complex <span class="title">ret</span><span class="params">(na,nb)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Complex Complex::<span class="keyword">operator</span> / (Complex&amp; c)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">double</span> cm = c.a*c.a + c.b+c.b;</span><br><span class="line">	<span class="keyword">double</span> na = (a * c.a - b * c.b) / cm;</span><br><span class="line">	<span class="keyword">double</span> nb = (b * c.a - a * c.b) / cm;</span><br><span class="line">	<span class="function">Complex <span class="title">ret</span><span class="params">(na,nb)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> Complex::<span class="keyword">operator</span> == (Complex&amp; c)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> (a==c.a) &amp;&amp; (b==c.b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> Complex::<span class="keyword">operator</span> != (Complex&amp; c)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> !(*<span class="keyword">this</span> == c);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">Complex&amp;  Complex::<span class="keyword">operator</span> = (<span class="keyword">const</span> Complex&amp; c)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">if</span>(<span class="keyword">this</span> != &amp;c)</span><br><span class="line">	&#123;</span><br><span class="line">		a = c.a;</span><br><span class="line">		b = c.b;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试主程序</strong></p>
<figure class="highlight llvm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">#include <span class="string">&quot;stdafx.h&quot;</span></span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include <span class="string">&quot;complex.h&quot;</span></span><br><span class="line"></span><br><span class="line">int main()</span><br><span class="line">&#123;</span><br><span class="line">	Complex <span class="keyword">c</span><span class="number">1</span>(<span class="number">1</span><span class="punctuation">,</span><span class="number">2</span>)<span class="comment">;</span></span><br><span class="line">	Complex <span class="keyword">c</span><span class="number">2</span>(<span class="number">3</span><span class="punctuation">,</span><span class="number">6</span>)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">	Complex <span class="keyword">c</span><span class="number">3</span> <span class="operator">=</span><span class="keyword">c</span><span class="number">1</span> + <span class="keyword">c</span><span class="number">2</span><span class="comment">;</span></span><br><span class="line">	Complex <span class="keyword">c</span><span class="number">4</span> <span class="operator">=</span><span class="keyword">c</span><span class="number">1</span> - <span class="keyword">c</span><span class="number">2</span><span class="comment">;</span></span><br><span class="line">	Complex <span class="keyword">c</span><span class="number">5</span> <span class="operator">=</span><span class="keyword">c</span><span class="number">1</span> * <span class="keyword">c</span><span class="number">2</span><span class="comment">;</span></span><br><span class="line">	Complex <span class="keyword">c</span><span class="number">6</span> <span class="operator">=</span><span class="keyword">c</span><span class="number">1</span> / <span class="keyword">c</span><span class="number">2</span><span class="comment">;</span></span><br><span class="line"></span><br><span class="line">	printf(<span class="string">&quot;c3.a = %f, c3.b = %f\n&quot;</span><span class="punctuation">,</span><span class="keyword">c</span><span class="number">3</span>.getA()<span class="punctuation">,</span><span class="keyword">c</span><span class="number">3</span>.getB())<span class="comment">;</span></span><br><span class="line">	printf(<span class="string">&quot;c4.a = %f, c4.b = %f\n&quot;</span><span class="punctuation">,</span><span class="keyword">c</span><span class="number">4</span>.getA()<span class="punctuation">,</span><span class="keyword">c</span><span class="number">4</span>.getB())<span class="comment">;</span></span><br><span class="line">	printf(<span class="string">&quot;c5.a = %f, c5.b = %f\n&quot;</span><span class="punctuation">,</span><span class="keyword">c</span><span class="number">5</span>.getA()<span class="punctuation">,</span><span class="keyword">c</span><span class="number">5</span>.getB())<span class="comment">;</span></span><br><span class="line">	printf(<span class="string">&quot;c6.a = %f, c6.b = %f\n&quot;</span><span class="punctuation">,</span><span class="keyword">c</span><span class="number">6</span>.getA()<span class="punctuation">,</span><span class="keyword">c</span><span class="number">6</span>.getB())<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">	Complex <span class="keyword">c</span><span class="number">7</span>(<span class="number">1</span><span class="punctuation">,</span><span class="number">-4</span>)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">	printf(<span class="string">&quot;c4 == c7: %d\n&quot;</span><span class="punctuation">,</span><span class="keyword">c</span><span class="number">4</span> <span class="operator">=</span><span class="operator">=</span> <span class="keyword">c</span><span class="number">7</span>)<span class="comment">;</span></span><br><span class="line">	printf(<span class="string">&quot;c4 != c7: %d\n&quot;</span><span class="punctuation">,</span><span class="keyword">c</span><span class="number">4</span> !<span class="operator">=</span> <span class="keyword">c</span><span class="number">7</span>)<span class="comment">;</span></span><br><span class="line"></span><br><span class="line">	return <span class="number">0</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"><span class="keyword">c</span><span class="number">3</span>.a <span class="operator">=</span> <span class="number">4.000000</span><span class="punctuation">,</span> <span class="keyword">c</span><span class="number">3</span>.b <span class="operator">=</span> <span class="number">8.000000</span></span><br><span class="line"><span class="keyword">c</span><span class="number">4</span>.a <span class="operator">=</span> <span class="number">-2.000000</span><span class="punctuation">,</span> <span class="keyword">c</span><span class="number">4</span>.b <span class="operator">=</span> <span class="number">-4.000000</span></span><br><span class="line"><span class="keyword">c</span><span class="number">5</span>.a <span class="operator">=</span> <span class="number">-9.000000</span><span class="punctuation">,</span> <span class="keyword">c</span><span class="number">5</span>.b <span class="operator">=</span> <span class="number">12.000000</span></span><br><span class="line"><span class="keyword">c</span><span class="number">6</span>.a <span class="operator">=</span> <span class="number">-0.428571</span><span class="punctuation">,</span> <span class="keyword">c</span><span class="number">6</span>.b <span class="operator">=</span> <span class="number">0.000000</span></span><br><span class="line"><span class="keyword">c</span><span class="number">4</span> <span class="operator">=</span><span class="operator">=</span> <span class="keyword">c</span><span class="number">7</span>: <span class="number">0</span></span><br><span class="line"><span class="keyword">c</span><span class="number">4</span> !<span class="operator">=</span> <span class="keyword">c</span><span class="number">7</span>: <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>注意事项：<br>C++规定赋值操作符（=）只能重载为成员函数<br>操作符重载不能改变原操作符的优先级<br>操作符重载不能改变操作数的个数<br>操作符重载不应改变操作符的原有语义</p>
<p><strong>有趣的重载</strong><br>重载左移操作符，将变量或常量左移到一个对象中！<br><strong>手动通过重载简单实现cout</strong></p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> <span class="built_in">endl</span> = <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Console</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="built_in">Console</span>&amp; <span class="keyword">operator</span> &lt;&lt; (<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,i);</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Console</span>&amp; <span class="keyword">operator</span> &lt;&lt; (<span class="keyword">char</span> c)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,c);</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Console</span>&amp; <span class="keyword">operator</span> &lt;&lt; (<span class="keyword">char</span>* c)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%s&quot;</span>,c);</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">Console</span>&amp; <span class="keyword">operator</span> &lt;&lt; (<span class="keyword">double</span> f)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%f&quot;</span>,f);</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">Console</span> <span class="built_in">cout</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="number">1</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span> &lt;&lt; <span class="string">&quot;123\n&quot;</span> &lt;&lt; <span class="number">1.25</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C-标准库"><a href="#C-标准库" class="headerlink" title="C++标准库"></a>C++标准库</h1><p>C++标准库并不是C++语言的一部分<br>C++标准库是由类库和函数库组成的集合<br>C++标准库中定义的类和对象都位于std命名空间中<br>C++标准库的头文件都不带.h后缀<br>C++标准库涵盖了C库的功能</p>
<h2 id="1、C-编译环境的组成"><a href="#1、C-编译环境的组成" class="headerlink" title="1、C++编译环境的组成"></a>1、C++编译环境的组成</h2><p>插图</p>
<h2 id="2、C-标准库预定义了多数常用的数据结构"><a href="#2、C-标准库预定义了多数常用的数据结构" class="headerlink" title="2、C++标准库预定义了多数常用的数据结构"></a>2、C++标准库预定义了多数常用的数据结构</h2><table>
<thead>
<tr>
<th></th>
<th></th>
<th></th>
</tr>
</thead>
<tbody><tr>
<td><bitset></td>
<td><set></td>
<td><cstdio></td>
</tr>
</tbody></table>
<p><strong>编程体验c++标准库</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Hello Word！&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> a;</span><br><span class="line">	<span class="keyword">double</span> b;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;input a: &quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; a;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;input b: &quot;</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; b;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">double</span> c = <span class="built_in">sqrt</span>(a*a + b*b);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;c = &quot;</span> &lt;&lt; c &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="C-中的字符串类"><a href="#C-中的字符串类" class="headerlink" title="C++中的字符串类"></a>C++中的字符串类</h1><p>C++ 语言直接支持C语言所有的概念<br>C++ 语言中没有原生的字符串类型<br>C++ 标准库提供了string类型<br>string 直接支持字符串连接<br>string 直接支持字符串的大小比较<br>string 直接支持子串查找和提取<br>string 直接支持字符串的插入和替换</p>
<p>字符串与数字的转换<br>标准库中提供了相关类对字符串和数字的转换<br>字符串流类（sstream）用于string的转换</p>
<ul>
<li><sstream> -相关头文件</li>
<li>istringstream -字符串输入流</li>
<li>ostringstream -字符串输出流</li>
</ul>
<p>使用方法<br>string-&gt;数字</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">istringstream iss(<span class="string">&quot;123.45&quot;</span>)<span class="comment">;</span></span><br><span class="line">double num<span class="comment">;</span></span><br><span class="line">iss &gt;&gt; num<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p>数字-&gt;string</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ostringstream oss<span class="comment">;</span></span><br><span class="line">oss &lt;&lt; <span class="number">562.63</span><span class="comment">;</span></span><br><span class="line">string s = oss.str()<span class="comment">;</span></span><br></pre></td></tr></table></figure>
<p><strong>编程实现</strong><br>字符串转换为数字与数字转换为字符串的功能</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TO_NUMBER(str,n) (istringstream(str) &gt;&gt; n)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> TO_STRING(n) (((ostringstream&amp;)(ostringstream() &lt;&lt; n)).str())</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="keyword">double</span> n;</span><br><span class="line">	TO_NUMBER(<span class="string">&quot;1.23&quot;</span>,n);</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; n &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; TO_STRING(<span class="number">12.34</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"><span class="number">1.23</span></span><br><span class="line"><span class="number">12.34</span></span><br></pre></td></tr></table></figure>
<p>字符串循环右移</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="built_in">string</span> <span class="title">right_func</span><span class="params">(<span class="keyword">const</span> <span class="built_in">string</span>&amp; s, <span class="keyword">unsigned</span> <span class="keyword">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">string</span> ret = <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> pos;</span><br><span class="line"></span><br><span class="line">	n = n % s.length();</span><br><span class="line">	pos = s.length() - n;</span><br><span class="line"></span><br><span class="line">	ret = s.substr(pos);</span><br><span class="line">	ret += s.substr(<span class="number">0</span>,pos);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="built_in">string</span> r = right_func(<span class="string">&quot;123456&quot;</span>,<span class="number">8</span>); <span class="comment">//循环右移8位</span></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; r &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"><span class="number">561234</span></span><br></pre></td></tr></table></figure>
<h1 id="数组操作符的重载"><a href="#数组操作符的重载" class="headerlink" title="数组操作符的重载"></a>数组操作符的重载</h1><p><strong>字符串类的兼容性</strong><br>string类最大限度的考虑了C字符串的兼容性<br>可以按照使用C字符串的方式使用string对象<br><strong>被忽略的事实</strong><br>-数组访问符是C/C++中的内置操作符<br>数组访问符的原生意义是数组访问和指针运算</p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[n] &lt;--&gt; *(a + n) &lt;--&gt; *(n + a) &lt;--&gt; n[a]</span><br></pre></td></tr></table></figure>
<p><strong>优化数组类</strong><br><strong>interry.h文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifndef</span> _INTARRY_H_</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> _INTARRY_H_</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">IntArry</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> m_length;</span><br><span class="line">	<span class="keyword">int</span>* m_pointer;</span><br><span class="line">	IntArry(<span class="keyword">int</span> len);</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">construct</span><span class="params">()</span></span>;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">static</span> IntArry* <span class="title">NewIntArry</span><span class="params">(<span class="keyword">int</span> len)</span></span>;</span><br><span class="line">	IntArry(<span class="keyword">const</span> IntArry&amp; obj);</span><br><span class="line">	~IntArry();</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">length</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span>&amp; value)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span></span>;</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">free</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="function">IntArry&amp; <span class="title">self</span><span class="params">()</span></span>;</span><br><span class="line">	<span class="keyword">int</span>&amp; <span class="keyword">operator</span> [] (<span class="keyword">int</span> n);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br></pre></td></tr></table></figure>
<p><strong>interry.cpp文件</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;StdAfx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">IntArry::IntArry(<span class="keyword">int</span> len)</span><br><span class="line">&#123;</span><br><span class="line">	m_length = len;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IntArry::construct</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> ret = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">	m_pointer = <span class="keyword">new</span> <span class="keyword">int</span>[m_length];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( m_pointer )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m_length; i++)</span><br><span class="line">		&#123;</span><br><span class="line">			m_pointer[i] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		ret = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">IntArry::IntArry(<span class="keyword">const</span> IntArry&amp; obj)</span><br><span class="line">&#123;</span><br><span class="line">	m_pointer = <span class="keyword">new</span> <span class="keyword">int</span>[obj.m_length];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; obj.m_length; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[i] = obj.m_pointer[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	m_length = obj.m_length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">IntArry* <span class="title">IntArry::NewIntArry</span><span class="params">(<span class="keyword">int</span> len)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	IntArry* ret = <span class="keyword">new</span> IntArry(len);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(!(ret &amp;&amp; ret-&gt;construct()))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">delete</span>[] ret;</span><br><span class="line">		ret = <span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">IntArry::length</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> m_length;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IntArry::get</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span>&amp; value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> ret = ( <span class="number">0</span>&lt;= index) &amp;&amp; (index &lt;= m_length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( ret )</span><br><span class="line">	&#123;</span><br><span class="line">		value = m_pointer[index];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">IntArry::set</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> value)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> ret = ( <span class="number">0</span>&lt;= index) &amp;&amp; (index &lt;= m_length);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>( ret )</span><br><span class="line">	&#123;</span><br><span class="line">		m_pointer[index] = value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> ret;	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">IntArry::~IntArry()</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">delete</span>[]m_pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span>&amp; IntArry::<span class="keyword">operator</span> [] (<span class="keyword">int</span> n)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> m_pointer[n];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">IntArry&amp; <span class="title">IntArry::self</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>测试主函数</strong></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;intarry.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	IntArry* a = IntArry::NewIntArry(<span class="number">5</span>);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>(a != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		IntArry&amp; arry = a-&gt;self();</span><br><span class="line"></span><br><span class="line">		arry[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;arry.length(); i++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; arry[i] &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"><span class="number">1</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">0</span></span><br><span class="line"><span class="number">0</span></span><br></pre></td></tr></table></figure>
<h1 id="经典问题解析"><a href="#经典问题解析" class="headerlink" title="经典问题解析"></a>经典问题解析</h1><h2 id="1、关于赋值的疑问"><a href="#1、关于赋值的疑问" class="headerlink" title="1、关于赋值的疑问"></a>1、关于赋值的疑问</h2><p>编译器为每个类默认重载了赋值操作符<br>默认的赋值操作符仅完成浅拷贝<br>当需要进行深拷贝时必须重载赋值操作符<br>赋值操作符与拷贝构造函数有相同的存在意义</p>
<blockquote>
<p>一般性原则<br>重载赋值操作符，必然需要实现深拷贝</p>
</blockquote>
<p>编译器默认提供的函数</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="symbol">Test</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上述函数体等价于</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="keyword">Test</span></span><br><span class="line">&#123;</span><br><span class="line">public:</span><br><span class="line">	<span class="keyword">Test</span>();</span><br><span class="line">	<span class="keyword">Test</span>(<span class="keyword">const</span> <span class="keyword">Test</span>&amp; );</span><br><span class="line">	<span class="keyword">Test</span> operator = (<span class="keyword">const</span> <span class="keyword">Test</span>&amp;);</span><br><span class="line">	~<span class="keyword">Test</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="2、关于string的疑问"><a href="#2、关于string的疑问" class="headerlink" title="2、关于string的疑问"></a>2、关于string的疑问</h2><p>string 类通过一个数据空间保存字符数据<br>string 类通过一个成员变量保存当前字符串长度<br>C++开发时尽量避开C语言中惯用的编程思想</p>
<h1 id="智能指针"><a href="#智能指针" class="headerlink" title="智能指针"></a>智能指针</h1><p>一个特殊的指针，指针生命周期结束时主动释放堆空间，一片堆空间最多智能由一个指针标识，杜绝指针运算和指针比较</p>
<blockquote>
<p>智能用来指向堆空间中的对象或者变量</p>
</blockquote>
<p><strong>编程实现</strong><br>通过重载指针操作符(-&gt;和*)，使用对象代替指针 </p>
<h1 id="逻辑操作符的陷阱"><a href="#逻辑操作符的陷阱" class="headerlink" title="逻辑操作符的陷阱"></a>逻辑操作符的陷阱</h1><p>C++通过函数调用扩展操作符的功能，进入函数体前必须完成所有参数的计算，函数参数的计算次序是不定的，短路法则则完全失效</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test(<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		value = i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> &amp;&amp; (<span class="keyword">const</span> Test&amp; l,<span class="keyword">const</span> Test&amp; r)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> l.getValue() &amp;&amp; r.getValue();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">bool</span> <span class="keyword">operator</span> || (<span class="keyword">const</span> Test&amp; l,<span class="keyword">const</span> Test&amp; r)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> l.getValue() || r.getValue();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">Test <span class="title">func</span><span class="params">(Test t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Test func(Test t): t.value = &quot;</span> &lt;&lt; t.getValue() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="function">Test <span class="title">t0</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="function">Test <span class="title">t1</span><span class="params">(<span class="number">1</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(func(t0) &amp;&amp; func(t1)) <span class="comment">// 等价于调用 operator &amp;&amp;( func(t0), func(t1)) 函数</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result is true!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result is false!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span>(func(t0) || func(t1)) <span class="comment">// 等价于调用 operator ||( func(t0), func(t1)) 函数</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result is true!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Result is false!&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"><span class="function">Test <span class="title">func</span><span class="params">(Test t)</span>: t.value </span>= <span class="number">1</span></span><br><span class="line"><span class="function">Test <span class="title">func</span><span class="params">(Test t)</span>: t.value </span>= <span class="number">0</span></span><br><span class="line">Result is <span class="literal">false</span>!</span><br><span class="line"></span><br><span class="line"><span class="function">Test <span class="title">func</span><span class="params">(Test t)</span>: t.value </span>= <span class="number">1</span></span><br><span class="line"><span class="function">Test <span class="title">func</span><span class="params">(Test t)</span>: t.value </span>= <span class="number">0</span></span><br><span class="line">Result is <span class="literal">true</span>!</span><br></pre></td></tr></table></figure>
<blockquote>
<p>不推荐重载逻辑与或 ，逻辑操作符重载后无法实现原生的语义<br>通过重载比较操作符代替逻辑操作符重载<br>直接使用成员函数代替逻辑操作符重载<br>使用全局函数对对逻辑操作符进行重载</p>
</blockquote>
<h1 id="逗号表达式的重载"><a href="#逗号表达式的重载" class="headerlink" title="逗号表达式的重载"></a>逗号表达式的重载</h1><p>逗号表达式用于将多个字表达式连接为一个表达式,逗号表达式的值为最后一个子表达式的值,逗号表达式,的前N-1个子表达式可以没有返回值,逗号表达式按照从左向右的顺序计算每个子表达式的值</p>
<figure class="highlight smali"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exp1 , exp2 , exp3 , ... , expN</span><br></pre></td></tr></table></figure>
<p>在C++中使用全局函数对逗号操作符进行重载，重载函数的参数必须有一个是类类型，重载函数的返回值必须是引用</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Class&amp; , (<span class="keyword">const</span> Class&amp; a, <span class="keyword">const</span> Class&amp; b)</span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">const_cast</span>&lt;Class&amp;&gt;(b);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>建议使用全局函数重载逗号操作符</p>
<p>存在问题<br>C++通过函数调用扩展操作符的功能，进入函数体前必须完成所有参数的计算，函数参数的计算次序是不定的，重载后无法严格从左向右计算表达式，工程开发中不要重载逗号操作符</p>
<h1 id="前置操作符与后置操作符的重载"><a href="#前置操作符与后置操作符的重载" class="headerlink" title="前置操作符与后置操作符的重载"></a>前置操作符与后置操作符的重载</h1><p>++ 操作符可以被重载，全局函数和成员函数均可以进行重载，重载前置++操作符不需要额外的参数，重载后置 ++ 操作符需要一个 int 类型的占位参数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test(<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		value = i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Test&amp; <span class="keyword">operator</span> ++ () <span class="comment">// 前置++实现</span></span><br><span class="line">	&#123;</span><br><span class="line">		++value;</span><br><span class="line">		<span class="keyword">return</span> *<span class="keyword">this</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Test <span class="keyword">operator</span> ++ (<span class="keyword">int</span>) <span class="comment">//后置++实现</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">Test <span class="title">ret</span><span class="params">(value)</span></span>;</span><br><span class="line"></span><br><span class="line">		value++;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="function">Test <span class="title">t0</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line">	Test t1 = t0++;</span><br><span class="line">	</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; t0.getValue() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; t1.getValue() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	Test t2 = ++t0;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; t0.getValue() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; t2.getValue() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="类型转换函数"><a href="#类型转换函数" class="headerlink" title="类型转换函数"></a>类型转换函数</h1><p>构造函数可以定义不同类型的参数，参数满足下列条件时称为<strong>转换构造函数</strong>：有且仅有一个参数、参数是基本类型、参数是其他类类型</p>
<figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Test </span>t;</span><br><span class="line">t = 100;</span><br></pre></td></tr></table></figure>
<p>编译器会尽量尝试让源码通过编译，当将100赋值给对象t时，编译器首先看看有没有转换构造函数，如果有转换构造函数则进行转换</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		value = <span class="number">0</span>;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	Test(<span class="keyword">int</span> i)   <span class="comment">//转换构造函数</span></span><br><span class="line">	&#123;</span><br><span class="line">		value = i;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	Test t ;</span><br><span class="line"></span><br><span class="line">	t = <span class="number">5</span>; <span class="comment">//进行隐式类型转换，调用转换构造函数，==&gt; t = Test(5)</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>编译器尽量尝试的结果是隐式类型转换：会让程序以意想不到的方式进行工作，是工程中bug的重要来源</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()&#123;&#125;;</span><br><span class="line">	Test(<span class="keyword">int</span> i)</span><br><span class="line">	&#123;</span><br><span class="line">		value = i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Test <span class="keyword">operator</span> + (<span class="keyword">const</span> Test&amp; obj) </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">Test <span class="title">ret</span><span class="params">(value+ obj.value)</span></span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	Test t ;</span><br><span class="line"></span><br><span class="line">	t = <span class="number">5</span>;</span><br><span class="line"></span><br><span class="line">	Test r;</span><br><span class="line"></span><br><span class="line">	r = t + <span class="number">5</span>; <span class="comment">// ==&gt; r = t + Test(5); 编译器自作聪明的编译通过，容易产生bug</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; r.getValue() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>C++编译器通过explicit关键字杜绝编译器的转换尝试，转换构造函数被explicit修饰时只能进行显示转换<br>转换方式</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">static_cast</span>&lt;ClassName&gt;(value)</span><br><span class="line">ClassName(value)</span><br><span class="line">(ClassName)value <span class="comment">//不推荐</span></span><br></pre></td></tr></table></figure>
<p>手动进行转换</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// test.cpp : 定义控制台应用程序的入口点。</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">explicit</span> <span class="title">Test</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		value = i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Test <span class="keyword">operator</span> + (<span class="keyword">const</span> Test&amp; obj) </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">Test <span class="title">ret</span><span class="params">(value+ obj.value)</span></span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	Test t ;</span><br><span class="line">	</span><br><span class="line">	t = <span class="keyword">static_cast</span>&lt;Test&gt;(<span class="number">5</span>); <span class="comment">// 手动类型转换</span></span><br><span class="line">	Test r;</span><br><span class="line"></span><br><span class="line">	r = t + Test(<span class="number">5</span>) + (Test)<span class="number">3</span>; <span class="comment">// 手动类型转换</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; r.getValue() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>C++中可以定义<strong>类型转换函数</strong>，类型转换函数用于将类对象转化为其他类型</p>
<figure class="highlight ada"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">operator <span class="keyword">Type</span> <span class="type">()</span></span><br><span class="line"><span class="type">&#123;</span></span><br><span class="line"><span class="type">	</span><span class="keyword">Type</span> <span class="type">ret;</span></span><br><span class="line"><span class="type"></span></span><br><span class="line"><span class="type">	</span><span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>类型转换函数与转换构造函数具有同等的地位、使得编译器有能力将类对象转化为其他类型，编译器能够隐式使用类型转换函数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">explicit</span> <span class="title">Test</span><span class="params">(<span class="keyword">int</span> i)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		value = i;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">getValue</span><span class="params">()</span> <span class="keyword">const</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Test <span class="keyword">operator</span> + (<span class="keyword">const</span> Test&amp; obj) </span><br><span class="line">	&#123;</span><br><span class="line">		<span class="function">Test <span class="title">ret</span><span class="params">(value+ obj.value)</span></span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">operator</span> <span class="title">int</span> <span class="params">()</span> <span class="comment">//类型转换函数</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">	<span class="function">Test <span class="title">t</span><span class="params">(<span class="number">5</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	i = t; <span class="comment">//编译器隐式调用类型转换函数 == &gt; t.operator int()</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; i &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>谨慎使用隐式类型转换，非常容易引入bug</p>
</blockquote>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tmp</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Tmp(<span class="keyword">int</span>) <span class="comment">//类型转换函数</span></span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		value = <span class="number">0</span>;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">operator</span> <span class="title">Tmp</span> <span class="params">()</span> <span class="comment">//转换构造函数</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="function">Tmp <span class="title">ret</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	Tmp i = <span class="number">0</span>;</span><br><span class="line">	Test t;</span><br><span class="line"></span><br><span class="line">	Tmp = t; <span class="comment">// 转换构造函数与类型转换函数相互冲突</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以通过在转换构造函数前加explicit关键字解决，在实际工程中通常不使用转换构造函数而采用普通构造函数的方式实现转换</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Tmp</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Tmp(<span class="keyword">int</span>)</span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">	<span class="keyword">int</span> value;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Test()</span><br><span class="line">	&#123;</span><br><span class="line">		value = <span class="number">0</span>;</span><br><span class="line">	&#125;;</span><br><span class="line"></span><br><span class="line">	<span class="function">Tmp <span class="title">toTmp</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="function">Tmp <span class="title">ret</span><span class="params">(<span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> ret;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	Tmp i = <span class="number">0</span>;</span><br><span class="line">	Test t;</span><br><span class="line"></span><br><span class="line">	i = t.toTmp(); <span class="comment">// 通过构造函数实现类的类型转换</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="继承的概念和意义"><a href="#继承的概念和意义" class="headerlink" title="继承的概念和意义"></a>继承的概念和意义</h1><p>面向对象中的继承指类之间的父子关系：子类拥有父类的所有属性和行为、子类就是一种特殊的父类、子类对象可以当做父类对象使用、子类中可以添加父类没有的方法和属性</p>
<figure class="highlight angelscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="symbol">Parent</span></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="symbol">Child</span> : <span class="symbol">public</span> <span class="symbol">Parent</span> //描述继承关系</span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>子类是一个特殊的父类，子类对象可以直接初始化父类对象，子类对象可以直接赋值给父类对象。</p>
<p>继承是C++中代码复用的重要手段。通过继承可以获得父类所有功能，并且可以在子类中重写已有功能，或者添加新功能。</p>
<h2 id="继承中的访问级别"><a href="#继承中的访问级别" class="headerlink" title="继承中的访问级别"></a>继承中的访问级别</h2><p>面向对象中的访问级别不知是public和private，可以定义protected访问级别：protected修饰的成员不能被外界直接访问、修饰的成员可以被子类直接访问</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">protected</span> :  <span class="comment">//protected访问级别</span></span><br><span class="line">		<span class="keyword">int</span> mv;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Parent()</span><br><span class="line">	&#123;</span><br><span class="line">		mv = <span class="number">10</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">value</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mv;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> :</span> <span class="keyword">public</span> Parent <span class="comment">//描述继承关系</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">addValue</span><span class="params">(<span class="keyword">int</span> mv)</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> Parent::mv = Parent::mv + mv; <span class="comment">//子类直接访问父类私有成员</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	Child c;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; c.value() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; c.addValue(<span class="number">8</span>) &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="定义类时访问级别的选择"><a href="#定义类时访问级别的选择" class="headerlink" title="定义类时访问级别的选择"></a>定义类时访问级别的选择</h2><p>插图44课</p>
<h1 id="不同的继承方式"><a href="#不同的继承方式" class="headerlink" title="不同的继承方式"></a>不同的继承方式</h1><p>public继承<br>父类成员在子类中保持原有的访问级别<br>private继承<br>父类成员在子类中变为私有成员<br>protected继承<br>父类中的公有成员变为保护成员，其他成员保持不变</p>
<p>插图44课</p>
<p>继承成员的访问属性<br> = Max{继承方式，父类成员访问属性}</p>
<p>C++中的默认继承方式为private</p>
<p>一般而言，C++工程项目中只使用public继承，C++的派生语言只支持一种继承方式（public继承），protected和private继承带来的复杂性远大于使用性</p>
<h1 id="继承中的构造与析构"><a href="#继承中的构造与析构" class="headerlink" title="继承中的构造与析构"></a>继承中的构造与析构</h1><p>子类可以定义构造函数，子类的构造函数必须对继承而来的成员进行初始化：直接通过初始化列表或者赋值的方式进行初始化、调用父类的构造函数进行初始化</p>
<p>父类构造函数在子类中的调用方式：默认调用，适用于无参构造函数和使用默认参数的构造函数、显示调用，通过初始化列表进行调用，适用于所有父类构造函数</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Parent()</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Parent()&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Parent(<span class="built_in">string</span> s)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Parent(string s) : &quot;</span> &lt;&lt; s &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> :</span> <span class="keyword">public</span> Parent <span class="comment">//描述继承关系</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	Child() <span class="comment">//隐式调用父类构造函数Parent()</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Child()&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	Child(<span class="built_in">string</span> s)</span><br><span class="line">		: Parent(<span class="string">&quot;Parameter to Parent&quot;</span>) <span class="comment">//显示调用父类构造函数Parent(string s)</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;Child() : &quot;</span> &lt;&lt; s &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	Child c;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	<span class="function">Child <span class="title">cc</span><span class="params">(<span class="string">&quot;hello&quot;</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">Parent()</span><br><span class="line">Child()</span><br><span class="line"></span><br><span class="line">Parent(<span class="built_in">string</span> s) : Parameter to Parent</span><br><span class="line">Child() : hello</span><br></pre></td></tr></table></figure>
<blockquote>
<p>构造规则：子类对象在创建时会首先调用父类的构造函数、先执行父类构造函数<br>再执行子类的构造函数、父类构造函数可以被隐式调用或者显示调用</p>
</blockquote>
<p>对象创建时构造函数的调用顺序</p>
<ol>
<li>调用父类的构造函数</li>
<li>调用成员变量的构造函数</li>
<li>调用类自身的构造函数</li>
</ol>
<p><strong>口诀心法：</strong><br><strong>先父母、后客人、再自己</strong></p>
<p>析构函数的调用顺序与构造函数相反</p>
<ol>
<li>执行自身的析构函数</li>
<li>执行成员变量的析构函数</li>
<li>执行父类的析构函数</li>
</ol>
<h1 id="父子间的冲突"><a href="#父子间的冲突" class="headerlink" title="父子间的冲突"></a>父子间的冲突</h1><p>子类可以定义父类中的同名成员，子类中的成员将隐藏父类中的同名成员，父类中的同名成员依然存在于子类中，子类可以定义父类中的同名函数，使用作用域分辨符::访问父类中的同名成员和同名函数</p>
<p><strong>特殊的同名函数</strong><br>子类中可以定义父类中已经存在的成员函数，这种定义发生在继承中，叫函数重写，函数重写是同名覆盖的一种特殊情况</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mi;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mi;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child</span> :</span> <span class="keyword">public</span> Parent <span class="comment">//描述继承关系</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="keyword">int</span> mi;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">Get</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="keyword">return</span> mi;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	Child c;</span><br><span class="line"></span><br><span class="line">	c.mi = <span class="number">100</span>;</span><br><span class="line">	c.Parent::mi = <span class="number">10</span>; <span class="comment">//调用父类中的成员变量</span></span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; c.Get() &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; c.Parent::Get() &lt;&lt; <span class="built_in">endl</span>; <span class="comment">//调用父类同名的函数</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line"><span class="number">100</span></span><br><span class="line"><span class="number">10</span></span><br></pre></td></tr></table></figure>
<p><strong>父子间的赋值兼容</strong><br>子类对象可以当做父类对象使用（兼容性）：子类对象可以直接赋值给父类对象使用、子类对象可以直接初始化父类对象、父类指针可以直接指向子类对象、父类引用可以直接引用子类对象</p>
<p>当使用父类指针（引用）指向子类对象时，子类对象退化为父类对象，只能访问父类中定义的成员，可以访问被子类覆盖的同名成员</p>
<h1 id="多态的概念和意义"><a href="#多态的概念和意义" class="headerlink" title="多态的概念和意义"></a>多态的概念和意义</h1><p>根据实际的对象类型决定函数调用的具体目标，同样的语句在实际运行时有多种不同的表现形式</p>
<p>C++语言直接支持多态的概念，通过使用virtual关键字对多态进行支持，被virtual声明的函数被重写后具有多态特性，被virtual声明的函数叫做<strong>虚函数</strong>。</p>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Grandfather</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="comment">//通过关键字virtual实现多态</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I&#x27;m Grandfather&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Parent</span> :</span> Grandfather</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">print</span><span class="params">()</span> <span class="comment">//通过关键字virtual实现多态</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I&#x27;m Parent&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child_A</span> :</span> <span class="keyword">public</span> Parent <span class="comment">//描述继承关系</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I&#x27;m Child A&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Child_B</span> :</span> <span class="keyword">public</span> Parent <span class="comment">//描述继承关系</span></span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">()</span></span></span><br><span class="line"><span class="function">	</span>&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">&quot;I&#x27;m Child B&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;	</span><br><span class="line">	Child_A a;</span><br><span class="line">	Child_B b;</span><br><span class="line"></span><br><span class="line">	Parent* pa = &amp;a;</span><br><span class="line">	pa-&gt;<span class="built_in">print</span>();	</span><br><span class="line"></span><br><span class="line">	Parent&amp; A = a;</span><br><span class="line">	A.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line"></span><br><span class="line">	Parent* pb = &amp;b;</span><br><span class="line">	pb-&gt;<span class="built_in">print</span>();	</span><br><span class="line"></span><br><span class="line">	Parent&amp; B = b;</span><br><span class="line">	B.<span class="built_in">print</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">运行结果：</span><br><span class="line">I<span class="number">&#x27;</span>m Child A</span><br><span class="line">I<span class="number">&#x27;</span>m Child A</span><br><span class="line"></span><br><span class="line">I<span class="number">&#x27;</span>m Child B</span><br><span class="line">I<span class="number">&#x27;</span>m Child B</span><br></pre></td></tr></table></figure>
<p>多态的意义<br>在程序运行中展现出动态特性、函数重写必须多态实现，否则没有意义、多态是面向对象组件化和程序设计的基础特性</p>
<p>理论中的概念<br>静态联编，在程序编译期间就能确定具体的函数调用，如函数重载<br>动态联编，在程序实际运行后才能确定具体的函数调用，如函数重写</p>
<h1 id="对象模型"><a href="#对象模型" class="headerlink" title="对象模型"></a>对象模型</h1><p>class是一种特殊的struct，在内存中class依旧可以看做变量的集合，class与struct遵循相同的内存对齐规则，class中的成员函数与成员变量是分开存放的：每个对象有独立的成员变量、所有类对象共享类中的成员函数</p>
<p>运行时的对象退化为结构体的形式，所有的成员变量在内存中依次排布，成员变量间可能存在内存空隙，可以通过内存地址直接访问成员变量，访问权限关键字在运行时失效</p>
<p>继承对象模型<br>在C++编译器的内部类可以理解为结构体，子类是由父类成员叠加子类新成员得到的</p>
<p>C++多态的实现原理<br>当类中声明虚函数时，编译器会在类中生成一个虚函数表，虚函数表是一个存储成员函数地址的数据结构，虚函数表是由编译器自动生成与维护的，virtual成员函数会被编译器放入虚函数表中，存在虚函数时，每个对象中都有一个指向虚函数表的指针</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="未完待续…"><a href="#未完待续…" class="headerlink" title="未完待续….."></a>未完待续…..</h1>
    </div>

    
    
    

    <footer class="post-footer">
          

<div class="post-copyright">
<ul>
  <li class="post-copyright-author">
      <strong>本文作者： </strong>braon-z
  </li>
  <li class="post-copyright-link">
      <strong>本文链接：</strong>
      <a href="https://example.com/2020/02/05/c++%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="c++基础知识">https://example.com/2020/02/05/c++语言基础知识/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

          <div class="post-tags">
              <a href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" rel="tag"><i class="fa fa-tag"></i> 基础知识</a>
          </div>

        

          <div class="post-nav">
            <div class="post-nav-item">
                <a href="/2020/01/03/c%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" rel="prev" title="c语言基础知识">
                  <i class="fa fa-chevron-left"></i> c语言基础知识
                </a>
            </div>
            <div class="post-nav-item">
                <a href="/2020/11/23/linux%E9%A9%B1%E5%8A%A8-i2c%E6%A1%86%E6%9E%B6-%E9%87%8D%E6%9E%84/" rel="next" title="linux驱动-i2c">
                  linux驱动-i2c <i class="fa fa-chevron-right"></i>
                </a>
            </div>
          </div>
    </footer>
  </article>
</div>






    <div class="comments" id="valine-comments"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">braon-z</span>
</div>
<div class="wordcount">
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-line"></i>
    </span>
    <span title="站点总字数">477k</span>
  </span>
  <span class="post-meta-item">
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">7:13</span>
  </span>
</div>
<div class="busuanzi-count">
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/next-boot.js"></script>

  
<script src="/js/local-search.js"></script>






  
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>





<script>
NexT.utils.loadComments('#valine-comments', () => {
  NexT.utils.getScript('https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js', () => {
    new Valine(Object.assign({"enable":true,"appId":"VsC1eQwQ4Xltm5eA9iYGp3VU-gzGzoHsz","appKey":"kyfyE4RWl6aIojedbxcuJa3V","serverURLs":null,"placeholder":"Just go go","avatar":"mm","meta":["nick","mail","link"],"pageSize":10,"lang":null,"visitor":false,"comment_count":true,"recordIP":false,"enableQQ":false,"requiredFields":[]}, {
      el: '#valine-comments',
      path: "/2020/02/05/c++%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/",
      serverURLs: "https://vsc1eqwq.api.lncldglobal.com"
    }));
  }, window.Valine);
});
</script>




  <script src="/js/activate-power-mode.min.js"></script>
  <script>
    POWERMODE.colorful = true;
    POWERMODE.shake = false;
    document.body.addEventListener('input', POWERMODE);
  </script>
<div class="moon-menu">
  <div class="moon-menu-items">
    
    <div class="moon-menu-item" onclick="back2bottom()">
      <i class='fa fa-chevron-down'></i>    </div>
    
    <div class="moon-menu-item" onclick="back2top()">
      <i class='fa fa-chevron-up'></i>    </div>
    
  </div>
  <div class="moon-menu-button">
    <svg class="moon-menu-bg">
      <circle class="moon-menu-cricle" cx="50%" cy="50%" r="44%"></circle>
      <circle class="moon-menu-border" cx="50%" cy="50%" r="48%"></circle>
    </svg>
    <div class="moon-menu-content">
      <div class="moon-menu-icon"><i class='fas fa-ellipsis-v'></i></div>
      <div class="moon-menu-text"></div>
    </div>
  </div>
</div><script src="/js/injector.js"></script>
</body>
</html>
